%        File: variedades.tex
%     Created: sáb nov 10 05:00  2018 C
% Last Change: sáb nov 10 05:00  2018 C
%
\documentclass[12pt,a4paper]{book}
\usepackage[utf8]{inputenc}
\usepackage[spanish, es-noquoting]{babel}
\usepackage[left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm, mathtools}
\usepackage{tikz,tikz-cd}
\usetikzlibrary{arrows, babel}
\usepackage{url}
\usepackage[colorlinks=true,linktocpage=true,pagebackref=true,linkcolor=blue]{hyperref}
\usepackage{titlesec}
\usepackage{remreset}
\usepackage{enumitem}
\usepackage{titlepic}
\usepackage{graphicx}
\usepackage[mathscr]{eucal}
\usepackage{epigraph}

%Fuente Times:
\usepackage{newtxtext}
\usepackage{newtxmath}
%Fuente Libertine:
%\usepackage{libertine}
%\usepackage[libertine]{newtxmath}

\newtheorem{thm}{Teorema}[section]
\newtheorem{prop}[thm]{Proposición}
\newtheorem{lema}{Lema}
\newtheorem{corol}[thm]{Corolario}
\theoremstyle{definition} \newtheorem{defn}[thm]{Definición}
\theoremstyle{definition} \newtheorem{ejemplo}[thm]{Ejemplo}
\theoremstyle{definition} \newtheorem{ejercicio}[thm]{Ejercicio}
\theoremstyle{remark} \newtheorem*{obs}{Observación}


\def\CC{\mathbb{C}}
\def\ZZ{\mathbb{Z}}
\def\RR{\mathbb{R}}
\def\KK{\mathbb{K}}
\def\SF{\mathbb{S}}
\def\TT{\mathbb{T}}
\def\NN{\mathbb{N}}
\def\HH{\mathbb{H}}
\def\PP{\mathbb{P}}
\def\id{\mathrm{id}}
\def\im{\mathrm{im}\ }
\def\pr{\mathrm{pr}}
\def\cc{\mathbf{c}}
\def\xx{\mathtt{x}}
\def\FF{\mathscr{F}}
\def\eps{\varepsilon}
\newcommand{\ve}[1]{\mathbf{#1}}

\DeclarePairedDelimiter\esc{\langle}{\rangle}
\DeclarePairedDelimiter\norm{\lVert}{\rVert}

		      \let\emph\relax
		      \DeclareTextFontCommand{\emph}{\it\bfseries}

		      \newcommand\cev[1]{\overset{\leftarrow}{#1}}
		      \newcommand\gen[1]{\left\langle #1 \right\rangle}
		      \newcommand\ngen[1]{\left\langle\left\langle #1 \right\rangle \right\rangle}

		      \title{VARIEDADES DIFERENCIABLES}
		      \author{Guillermo Gallego Sánchez}
		      \date{Última versión: \today}
		      %\titlepic{\includegraphics{imagen.png}}


		      %Otro formato para las secciones
		      \titleformat{\section}[block]
		      {\fontsize{15}{18}\bfseries\sffamily\filcenter}
		      {\S \thesection.}
		      {1em}
		      {}

		      \begin{document}
		      \maketitle
		      \newpage\null\thispagestyle{empty}
		      \chapter*{Prefacio}
		      \newpage\null\thispagestyle{empty}\newpage
		      \newpage\null\thispagestyle{empty}
		      \epigraph{\textit{Hay otra cosa entre los antiguos Hobbits que merece mencionarse; un hábito sorprendente: absorbían o inhalaban, a través de pipas de arcilla o madera, el humo de la combustión de una hierba llamada hoja o hierba para pipa, quizás una variedad de la} Nicotiana\textit{. Hay mucho misterio en el origen de esta costumbre peculiar, o de este «arte», como los Hobbits preferían llamarlo.}}{}
		      \newpage\null\thispagestyle{empty}
		      
		      \chapter{Variedades diferenciables}
		      \section{El modelo local}

El propósito principal de la noción de variedad diferenciable consiste en \textit{generalizar el cálculo diferencial} a un espacio topológico. Para realizar esta tarea, es preciso recordar qué es el cálculo diferencial, y en qué categoría se realiza. 

Sean $U \subset \RR^n$ y $V \subset \RR^m$ conjuntos abiertos y una aplicación $f:U\rightarrow V$. Decimos que $f$ es una \emph{aplicación ($C^\infty$-) diferenciable} si todas las derivadas parciales de $f$ existen y son continuas en $U$. La regla de la cadena garantiza que, si $U \subset \RR^n$, $V\subset \RR^m$ y $W\subset \RR^p$ son abiertos y $f:U\rightarrow V$ y $g:V\rightarrow W$ es diferenciable, entonces su composición 
\begin{center}
  \begin{tikzcd}
    U \arrow{rr}{g\circ f} \arrow{dd}{f} && W    \\ 
    \\
    V \arrow{rruu}{g},
  \end{tikzcd}
\end{center}
es una aplicación diferenciable. Así, tenemos una categoría, que denotaremos $\mathbf{CartSp}$ y llamaremos \emph{espacios cartesianos} o \emph{espacios de coordenadas abstractos} cuyos objetos son los abiertos de los espacios afines y sus morfismos son las aplicaciones diferenciables entre ellos. Si $U\subset \RR^n$ es un abierto, denotamos por $C^\infty (U)$ a las funciones diferenciables $U\rightarrow \RR$, es decir, $C^\infty(U)=\mathbf{CartSp}(U,\RR)$.

Sea $V \subset \RR^m$ abierto. Se definen las \emph{funciones coordenadas} como las funciones
\begin{align*}
  \mathrm{pr}_i : V&\longrightarrow \RR\\ 
    (x^1,\dots,x^m) &\longmapsto x^i. 
  \end{align*}
  Sea $U\subset \RR^n$ abierto y $f:U\rightarrow V$. Se definen las \emph{componentes de $f$} como las funciones $f^i=\mathrm{pr}_i \circ f$, que son diferenciables por la regla de la cadena y denotamos $f=(f^1,\dots,f^m)$. Recíprocamente, si todas las componentes son diferenciables, entonces la aplicación es diferenciable.

Sean ahora $U$ y $V$ abiertos de $\RR^n$ y $\RR^m$, respectivamente y $f:U\rightarrow V$ una aplicación diferenciable entre ellos. Dado un punto $x\in U$, se define la \emph{derivada de $f$ en $x$} como la aplicación lineal $d_x f: \RR^n \rightarrow \RR^m$ cuya matriz asociada es la matriz jacobiana de $f$ en $x$, es decir
\begin{equation*}
  J_xf= \left(
  \begin{array}{ccc}
    \frac{\partial f^1}{\partial x^1}(x) & \cdots & \frac{\partial f^1 }{\partial x^n}(x) \\
     & \vdots &  \\
    \frac{\partial f^m}{\partial x^1}(x) & \cdots & \frac{\partial f^m }{\partial x^n}(x) 
  \end{array}
  \right).
\end{equation*}
De nuevo, la regla de la cadena garantiza que $d_x(g\circ f)=d_{f(x)}g \circ d_xf$. Por tanto, si consideramos la categoría $\mathbf{CartSp}_*$ de los espacios cartesianos \emph{con punto base} cuyos objetos son los pares $(U,x)$, con $U \subset \RR^n$ abierto y $x\in U$ y tal que los morfismos entre $(U,x)$ y $(V,y)$ son las aplicaciones diferenciables $f:U\rightarrow V$ tales que $f(x)=y$, entonces tenemos un funtor covariante 
\begin{align*}
  d :\mathbf{CartSp}_*&\longrightarrow \mathbf{Vect}_\RR
  \end{align*}
  que a cada par $(U,x)$, con $U\subset \RR^n$ abierto le asigna el espacio vectorial $\RR^n$ y a cada morfismo $f:(U,x)\rightarrow (V,f(x))$, con $V\subset \RR^m$ abierto, le asigna la aplicación lineal $d_xf:\RR^n \rightarrow \RR^m$.

  Un isomorfismo en la categoría $\mathbf{CartSp}$ se llama un \emph{difeomorfismo}. Es decir, un difeomorfismo es una aplicación diferenciable $f:U\rightarrow V$ tal que existe una aplicación diferenciable $f^{-1}:V\rightarrow U$, llamada \emph{inversa de $f$} tal que el siguiente diagrama conmuta
  \begin{center}
    \begin{tikzcd}
      U \arrow{rr}{f} \arrow{rrdd}{\id_U} && V \arrow{dd}{f^{-1}} \arrow{rrdd}{\id_V}     && \\ 
      && && \\
      && U \arrow{rr}{f} && V.
    \end{tikzcd}
  \end{center}
  Dos abiertos $U \subset \RR^n$, $V \subset \RR^m$ se dicen \emph{difeomorfos} si existe un difeomorfismo entre ellos. 

  \begin{prop}[Invariancia diferenciable de la dimensión] \label{dimension}
   Si dos abiertos $U \subset \RR^n$, $V \subset \RR^m$ son difeomorfos entonces $n=m$.
  \end{prop}
  \begin{proof}
    En efecto, si existe un difeomorfismo $f:U\rightarrow V$, entonces existe una aplicación diferenciable $f^{-1}:V\rightarrow U$ tal que el siguiente diagrama conmuta
\begin{center}
    \begin{tikzcd}
      U \arrow{rr}{f} \arrow{rrdd}{\id_U} && V \arrow{dd}{f^{-1}} \arrow{rrdd}{\id_V}     && \\ 
      && && \\
      && U \arrow{rr}{f} && V.
    \end{tikzcd}
  \end{center}
  Ahora, si consideramos un punto $x\in U$ e $y=f(x)$, la imagen del diagrama  anterior por el funtor $d$ es
  \begin{center}
    \begin{tikzcd}
      \RR^n \arrow{rr}{d_x f} \arrow{rrdd}{\id_{\RR^n}} && \RR^m \arrow{dd}{d_{y} (f^{-1})} \arrow{rrdd}{\id_{\RR^m}}     && \\ 
      && && \\
      && \RR^n \arrow{rr}{d_xf} && \RR^m.
    \end{tikzcd}
  \end{center}
  Tenemos entonces que $d_xf$ es un isomorfismo lineal, luego $\RR^n \cong \RR^m$ y por tanto sus dimensiones coinciden, es decir, $n=m$. Más aún, hemos probado que $d_y(f^{-1})=(d_x f)^{-1}$.
  \end{proof}

  El recíproco de este resultado es cierto \textit{localmente}. En efecto, el teorema de la función inversa garantiza que si $f:U \rightarrow V$ es una aplicación diferenciable tal que $d_xU$ es un isomorfismo lineal, para cierto $x \in U$, entonces existe un entorno abierto $W\subset U$ de $x$ tal que $f|_W:W\rightarrow f(W)$ es un difeomorfismo. Decimos entonces que $f$ es un \emph{difeomorfismo local}.
    
  \section{El concepto. Definición y ejemplos}
  \begin{defn}
    Un \emph{espacio localmente afín} es un espacio topológico $M$ localmente homeomorfo a un abierto de un espacio afín. Es decir, para todo $x\in M$ existe un entorno abierto $U\subset M$ de $x$, un abierto $V \subset \RR^n$ para cierto $n\in \NN$ y un homeomorfismo $\varphi:U\rightarrow V$. El abierto $U$ se llama \emph{dominio de coordenadas} y el difeomorfismo $\varphi$, \emph{sistema local de coordenadas} en $x$. El par $(U,\varphi)$ se llama una \emph{carta} de $M$ en $x$.

    Un espacio localmente afín que además es Hausdorff y segundo axioma de numerabilidad se llama una \emph{variedad topológica}.
  \end{defn}

  \begin{defn}
    Sea $M$ una variedad topológica y $x\in M$ un punto. Dadas dos cartas $(U_1,\varphi_1)$, $(U_2,\varphi_2)$, se define el \emph{cambio de coordenadas} como la aplicación $\psi_{12}$ que cierra el siguiente diagrama
    \begin{center}
      \begin{tikzcd}
	& U_1\arrow{rr}{\varphi_1} && V_1\subset \RR^n	\\ 
	& && \varphi_1(U_1\cap U_2) \arrow[hook]{u} \arrow{dd}{\psi_{12}} \\
	U_1 \cap U_2 \arrow[hook]{ruu} \arrow[hook]{rdd} \arrow{rrru} \arrow{rrrd}& && \\
	& && \varphi_2(U_1\cap U_2) \arrow[hook]{d}\\
	& U_2\arrow{rr}{\varphi_2} && V_2\subset \RR^m.\\	
      \end{tikzcd}
    \end{center}
  Es decir, $\psi_{12}=(\varphi_2\circ \varphi_1^{-1})|_{\varphi_1(U_1\cap U_2)}$.
  \end{defn}

  Nótese que por ser $\varphi_1$ y $\varphi_2$ homeomorfismos, el cambio de coordenadas $\psi_{12}$ es un homeomorfismo entre $\varphi_1(U_1\cap U_2)$ y 
  $\varphi_2(U_1\cap U_2)$, que son ambos abiertos de algún espacio afín. El caso que a nosotros nos incumbe es aquel en el que estos cambios de coordenadas son difeomorfismos, ya que queremos que nuestro modelo local sea la categoría $\mathbf{CartSp}$ cuyos morfismos eran las aplicaciones diferenciables.

  \begin{defn}
    
  Una variedad topológica se dice que es una \emph{variedad diferenciable} si, para todo punto $x\in M$ y para cualesquiera dos cartas $(U_1,\varphi_1)$, $(U_2,\varphi_2)$, el cambio de coordenadas $\psi_{12}$ es un difeomorfismo.

  \end{defn}

 Una consecuencia inmediata de la definición de variedad diferenciable y de la Proposición \ref{dimension}, es que todos los dominios de coordenadas en un punto $x \in M$ de una variedad diferenciable $M$ son abiertos del mismo $\RR^n$. Este $n$ se denomina \emph{dimensión de $M$ en $x$} y se denota $\dim_xM$. Nótese además que, de hecho, si $U_1$ y $U_2$ son dominios de coordenadas en $x$, todos los puntos de $U_1\cap U_2$ tienen la misma dimensión, luego, si consideramos la aplicación
  \begin{align*}
    \dim :M&\longrightarrow \NN\\ 
      x &\longmapsto \dim_x M, 
    \end{align*}
    y consideramos en $\NN$ la topología discreta, la aplicación $\dim$ es continua, ya que el conjunto $\dim^{-1}(\dim_x M)$ contiene a $U_1 \cap U_2$. Más aún, como la imagen continua de un conexo es un conexo, la dimensión es constante en cada componente conexa de $M$. Así, si $M$ es una variedad diferenciable conexa podemos hablar con propiedad de la \emph{dimensión} de $M$, $\dim M$, que será el número $\dim_x M$ para cualquier $x\in M$. Las variedades diferenciables de dimensión 1 se llaman \emph{curvas} y las de dimensión 2, \emph{superficies}. 

    \begin{ejemplo}
      Un primer ejemplo trivial es el propio $\RR^n$ con la topología usual, con la carta
      \begin{align*}
	\id_{\RR^n} :\RR^n&\longrightarrow \RR^n\\ 
	  x &\longmapsto x. 
	\end{align*}
	De la misma forma, cualquier abierto $U\subset \RR^n$ es también una variedad diferenciable de dimensión $n$.
      \qed
    \end{ejemplo}

    \begin{ejemplo}
      Consideramos la \emph{esfera $n$-dimensional}
      \begin{equation*}
	\SF^n=\left\{ x\in \RR^{n+1} : \norm{x}=1 \right\}.
      \end{equation*}
      Podemos considerar los abiertos $U_1=\SF^n-\{p_N\}$ y $U_2=\SF^n-\{p_S\}$, con $p_N=(0,\dots,0,1)$ y $p_S=(0,\dots,0,-1)$ los polos norte y sur de la esfera. Estos abiertos son homeomorfos a $\RR^n$ mediante las aplicaciones $\varphi_S:U_1\rightarrow \RR^n$ la proyección estereográfica centrada en el polo sur y $\varphi_N:U_2\rightarrow \RR^n$ la proyección estereográfica centrada en el polo norte. No es difícil comprobar que el cambio de coordenadas $(\varphi_N \circ \varphi_S^{-1})|_{\varphi_S(\SF^n-\left\{ p_N,p_S \right\})}$ es un difeomorfismo, de modo que $\SF^n$ es una variedad diferenciable.
      \qed
    \end{ejemplo}
     
    \begin{ejemplo}
      Consideramos el espacio proyectivo real $\PP_\RR^n$. Los conjuntos de la forma
      \begin{equation*}
	D(x_i)=\left\{ (x_0:\dots:x_n): x_i \neq 0 \right\}
      \end{equation*}
      son abiertos homeomorfos a $\RR^n$ por medio de 
      \begin{align*}
	\varphi_i :D(x_i) &\longrightarrow \RR^n\\ 
	(x_0:\dots:x_{i}:\dots:x_n) &\longmapsto \left(\frac{x_0}{x_i},\dots,\frac{x_{i-1}}{x_i},\frac{x_{i+1}}{x_i},\dots,\frac{x_n}{x_i}\right). 
	\end{align*}

	Los cambios de coordenadas vienen dados por
	\begin{equation*}
	  \psi_{ij}=(\varphi_j\circ \varphi_i^{-1})|_{\varphi_i(D(x_i)\cap D(x_j))},
	\end{equation*}
	que son de la forma
	\begin{equation*}
	  \psi\left( \frac{x_0}{x_i},\dots,\frac{x_n}{x_i} \right)=\left( \frac{x_0}{x_j},\dots,\frac{x_n}{x_j} \right)
	  	\end{equation*}
		y son claramente difeomorfismos.
      \qed
    \end{ejemplo}

    Regresando a la definición de variedad diferenciable. Nótese que esencialmente lo que pedimos a una variedad topológica $M$ para que sea variedad diferenciable es que admita un conjunto de cartas $\mathcal{U}$ tal que
\begin{itemize}
  \item los dominios de coordenadas recubran $M$, es decir, $M=\bigcup_{U\in \mathcal{U}}U$ y,
  \item los cambios de coordenadas sean difeomorfismos.
\end{itemize}

Un conjunto de cartas de estas características se denomina un \emph{atlas} de $M$. Así, dotar a $M$ de la estructura de variedad diferenciable es simplemente dar un atlas de $M$. Cabría preguntarse entonces si la elección de las cartas influirá en la estructura de variedad diferenciable que estamos dando. Dos cartas se dicen \emph{compatibles} si el cambio de coordenadas entre ellas es un difeomorfismo. Dos atlas se dicen \emph{compatibles} si todas las cartas de uno lo son con las del otro, es decir, si su unión es de nuevo un atlas. No es difícil comprobar que la compatibilidad entre atlas es una relación de equivalencia. De aquí se deduce que todo atlas es compatible con (es decir, está contenido en) un atlas maximal único, aquel que tiene todas las cartas compatibles con las del primero. Así, en vez de dar un atlas cualquiera, podemos considerar el atlas maximal correspondiente, de forma que tiene sentido decir que un atlas maximal es una \emph{estructura diferenciable}. Podemos entonces redefinir variedad diferenciable de la siguiente forma:

\begin{defn}
  Una variedad diferenciable es un par $(M,\mathcal{U}_M)$, donde $M$ es una variedad topológica y $\mathcal{U}_M$ es una estructura diferenciable (es decir, un atlas maximal) en $M$.
\end{defn}

\begin{obs}
  En ninguno de los ejemplos anteriores los atlas considerados eran maximales.
\end{obs}
  
\begin{ejemplo}
  En el caso del espacio proyectivo real $\PP^n_\RR$ cabría preguntarse si el atlas definido $\left\{ (D(x_i),\varphi_i) \right\}$ depende de la elección de coordenadas homogéneas. Esto no es así, ya que para cualquier hiperplano 
  \begin{equation*}
    H=\left\{ (x_0:\dots:x_n) \in \PP^n_\RR | F(x_0,\dots,x_n)=0 \right\},
  \end{equation*}
  con $F\in \RR[X_0,\dots,X_n]_1$ un polinomio homogéneo de grado 1, podemos considerar la carta $(D(H),\varphi_H)$, con $D(H)=\PP^n_\RR - H$ un abierto homeomorfo a un espacio afín 
  \begin{equation*}
    \mathbb{A}_\RR^n=\left\{ (x_0,\dots,x_n) \in \RR^{n+1} | F(x_0,\dots,x_1)=1 \right\}
  \end{equation*}
  por
  \begin{align*}
    \varphi_H :D(H)&\longrightarrow \mathbb{A}_\RR^n\\ 
    (x_0:\dots:x_n) &\longmapsto \frac{1}{F(x_0,\dots,x_n)}(x_0,\dots,x_n).
    \end{align*}
\end{ejemplo}

    \begin{obs}
      Cabe preguntarse ahora si será posible dotar a una misma variedad topológica de estructuras diferenciables diferentes. En efecto, esto puede hacerse: basta considerar dos atlas que no sean compatibles. Por ejemplo, consideramos en $\RR$ los homeomorfismos
      \begin{align*}
	\id_\RR:\RR&\longrightarrow \RR\\ 
	  t &\longmapsto t, 
	\end{align*}
	y
	\begin{align*}
	  \varphi :\RR&\longrightarrow \RR\\ 
	    t &\longmapsto t^3. 
	  \end{align*}
	  Cada una de estas cartas define un atlas por sí sola, es decir, $\mathcal{U}_1=\left\{ (\RR,\id_{\RR}) \right\}$ y $\mathcal{U}_2=\left\{ (\RR,\varphi) \right\}$. Pero estos atlas no son compatibles, ya que el cambio de coordenadas es
	  \begin{equation*}
	    \psi(t)=\varphi\circ \id^{-1} (t)= t^3,
	  \end{equation*}
	  que no es un difeomorfismo, ya que su inversa
	  \begin{equation*}
	    \psi^{-1}(t)=\sqrt[3]{t}
	  \end{equation*}
	  no es diferenciable en $t=0$. Por tanto, $\mathcal{U}_1$ y $\mathcal{U}_2$ darán dos estructuras diferenciables diferentes.
    \end{obs}

    \section{Aplicaciones diferenciables}
    \begin{defn}
      Sean dos variedades topológicas $M$ y $N$ y una aplicación continua $f:M\rightarrow N$. Sean $x\in M$, $(U,\varphi)$ una carta en $x$ y $(V,\psi)$ una carta en $f(x)$. Se llama \emph{localización} de $f$ a las cartas $(U,\varphi)$, $(V,\psi)$ a la aplicación $\tilde{f}$ que cierra el siguiente diagrama
      \begin{center}
	\begin{tikzcd}
U\subset M	  \arrow{rr}{f}\arrow{dd}[anchor=east]{\varphi} && V\subset N\arrow{dd}[anchor=west]{\psi} \\ 
	   && \\
	   \varphi(U)\subset \RR^m\arrow{rr}[anchor=south]{\tilde{f}} && \psi(V) \subset \RR^n.
	 \end{tikzcd}
       \end{center}
       Es decir, $\tilde{f}=\psi \circ f \circ \varphi^{-1}$.
    \end{defn}
    \begin{defn}
      Una aplicación $f:M\rightarrow N$ entre dos variedades diferenciables $M$ y $N$ es \emph{diferenciable} si, para todo $x\in M$ y para cualesquiera dos cartas $(U,\varphi)$, $(V,\psi)$ en $x$ y $f(x)$, respectivamente,  su localización $\tilde{f}=\psi^{-1}\circ f \circ \varphi$ es diferenciable. Es decir, si $\tilde{f} \in \mathbf{CartSp}(\varphi(U),\psi(V))$.
    \end{defn}

    Si $M$, $N$ y $P$ son variedades diferenciables y $f:M\rightarrow N$ y $g:N\rightarrow P$ son aplicaciones diferenciables, entonces la localización de $(g\circ f)$ a unas cartas $(U,\varphi)$, $(W,\eta)$ es la aplicación $\widetilde{(g\circ f)}$ dada por el siguiente diagrama
      \begin{center}
	\begin{tikzcd}
	  U\subset M	  \arrow{rr}{f}\arrow[bend left]{rrrr}{g\circ f} \arrow{dd}[anchor=east]{\varphi} && V\subset N\arrow{dd}[anchor=west]{\psi} \arrow{rr}{g} && W \subset P \arrow{dd}{\eta}\\ 
	   && \\
	   \varphi(U)\subset \RR^m\arrow{rr}[anchor=south]{\tilde{f}} \arrow[bend right]{rrrr}{\widetilde{(g\circ f)}}&& \psi(V) \subset \RR^n \arrow{rr}{\tilde{g}} && \eta(W) \subset \RR^p.
	 \end{tikzcd}
       \end{center}
       La regla de la cadena garantiza que, si $\tilde{f}$ y $\tilde{g}$ son diferenciables, entonces $\widetilde{(g\circ f)}=\tilde{g}\circ \tilde{f}$ es diferenciable, luego $g\circ f$ es diferenciable.

       Podemos por tanto definir la categoría de las variedades diferenciables, que denotamos $\mathbf{Diff}$, cuyos objetos son las variedades diferenciables y sus morfismos son las aplicaciones diferenciables entre ellas. Los isomorfismos de esta categoría también se llaman \emph{difeomorfismo}. Es decir, un difeomorfismo entre dos variedades diferenciables $M$ y $N$ es una aplicación diferenciable $f:M\rightarrow N$ biyectiva y con inversa diferenciable.

       \begin{ejemplo}
	 Una homografía $h:\PP^n_\RR \rightarrow \PP^m_\RR$ es una aplicación diferenciable. Basta tomar un hiperplano $H \subset \PP^n_\RR$, de modo que su imagen $h(H)\subset \PP^m_\RR$ es también un hiperplano, y considerar la localización a las cartas $(D(H),\varphi_H)$, $(D(h(H)),\varphi_{h(H)})$
      \begin{center}
	\begin{tikzcd}
	  D(H)	  \arrow{rr}{h}\arrow{dd}[anchor=east]{\varphi_H} && D(h(H))\arrow{dd}[anchor=west]{\varphi_{h(H)}} \\ 
	   && \\
	   \mathbb{A}_\RR^n \arrow{rr}[anchor=south]{\tilde{h}} && \mathbb{A}_\RR^m.
	 \end{tikzcd}
       \end{center}
       Por ser $h$ una homografía, su localización $\tilde{h}$ es una aplicación afín, luego es diferenciable. Por tanto, $h$ es diferenciable.
       \end{ejemplo}

       \begin{obs}
	 En una observación al final de la sección anterior vimos como una misma variedad topológica puede fácilmente admitir estructuras diferenciables distintas. Vimos concretamente el ejemplo de $\RR$ con la carta dada por la identidad y la dada por la función elevar al cubo. Sin embargo, aunque estas dos estructuras son diferentes, son difeomorfas. En efecto, basta considerar la aplicación
	 \begin{align*}
	   f :\RR&\longrightarrow \RR\\ 
	   t &\longmapsto t^3. 
	   \end{align*}
	   La localización de esta aplicación a las cartas $(\RR,\id_\RR)$ y $(\RR,\varphi)$ viene dada por el diagrama
      \begin{center}
	\begin{tikzcd}
\RR	  \arrow{rr}{f}\arrow{dd}[anchor=east]{\id} && \RR\arrow{dd}[anchor=west]{\varphi} \\ 
	   && \\
	   \RR\arrow{rr}[anchor=south]{\tilde{f}} && \RR.
	 \end{tikzcd}
       \end{center}
       Es decir, 
       \begin{equation*}
	 \tilde{f}(t)=\varphi^{-1}\circ \tilde{f} \circ \id (t)= \sqrt[3]{t^3}=t.
       \end{equation*}
       Por tanto, $\tilde{f}=\id$, luego es diferenciable. De hecho, es un difeomorfismo, luego $f$ es un difeomorfismo y $(\RR,\id_\RR)$ es difeomorfa a $(\RR,\varphi)$.
       \end{obs}

       Cabe preguntarse entonces si una misma variedad topológica admite diferentes estructuras diferenciables no difeomorfas, si es que admite alguna. Es decir, consideramos el problema de la \emph{clasificación de las variedades diferenciables}. Sea $M$ una variedad diferenciable conexa. Se tiene que:
       \begin{itemize}
	 \item Si $\dim M=0$, entonces $M$ es difeomorfa a un punto.
	 \item Si $\dim M = 1$, entonces la clasificación coincide con la clasificación de las curvas topológicas: $M$ es difeomorfa a la recta real $\RR$ si no es compacta o a la circunferencia $\SF^1$ si es compacta.
	 \item Si $\dim M = 2$ entonces la clasificación también coincide con la clasificación de las superficies topológicas, con lo que, si $M$ es compacta entonces es difeomorfa a una suma conexa de toros $\Sigma_g$, si es orientable o a una suma conexa de espacios proyectivos $X_k$ si no lo es.
	 \item Si $\dim M = 3$ la clasificación también coincide con el caso topológico, aunque en este caso la clasificación en el caso topológico no está completa.
	 \item En dimensión $\dim M \geq 4$ las cosas se complican, ya que aparecen variedades topológicas que admiten varias estructuras diferenciables no difeomorfas. Si $M$ es compacta y $\dim M \geq 5$, entonces $M$ puede admitir varias estructuras diferenciables no difeomorfas, aunque una cantidad finita. Por ejemplo, la esfera $\SF^7$ admite 28 estructuras diferenciables no difeomorfas entre sí («esferas exóticas»). En el caso en que $\dim M = 4$ entonces una variedad compacta $M$ puede admitir una cantidad infinita numerable de estructuras diferenciables. En el caso no compacto aparecen resultados realmente sorprendentes. Por ejemplo, mientras que $\RR^n$ admite una única estructura diferenciable salvo difeomorfismo si $n\neq 4$, $\RR^4$ admite una cantidad \textit{infinita no numerable} de estructuras diferenciables no difeomorfas. Estas variedades se conocen como los «falsos $\RR^4$».
       \end{itemize}

    \section{Haces y $C^\infty$-variedades}

    Sea $X$ un espacio topológico. Denotamos por $\mathbf{Op}(X)$ a la categoría cuyos objetos son los subconjuntos abiertos $U\subset X$ y tal que, si $U\subset X$ y $V\subset X$ son abiertos de $X$, entonces el conjunto de morfismos de $U$ a $V$, $\mathbf{Op}(X) (U,V)$ consta de:
    \begin{itemize}
      \item la inclusión $U\hookrightarrow V$ si $U\subset V$ y,
      \item es vacío en caso contrario.
    \end{itemize}

    \begin{defn}
      Un \emph{prehaz} sobre un espacio topológico $X$ es un funtor contravariante
      \begin{align*}
	\mathscr{F} :\mathbf{Op}(X)&\longrightarrow \mathbf{Set}.
	\end{align*}
    \end{defn}

	Es decir, un prehaz $\FF$ asigna a cada abierto $U\subset X$ un conjunto $\FF(U)$ y a cada par de abiertos $U$ y $V$ con $U\subset V$ le asigna una función
	\begin{align*}
	  \mathrm{res}_{U}^V :\FF(V)&\longrightarrow \FF(U)\\ 
	  s &\longmapsto s|_{U}. 
	  \end{align*}
	  Esta función se denomina \emph{restricción} de $V$ a $U$. Nótese que aquí la expresión $s|_{U}$ es simplemente una notación, pero que será consistente con los ejemplos que consideremos a continuación. Además, la funtorialidad asegura que, si $U \subset V \subset W$, entonces, para todo $s \in \FF(W)$, $(s|_V)|_U=s|_W$. Los elementos de $\FF(U)$ se denominan \emph{secciones} de $U$.

	  \begin{defn}
	    Un \emph{haz} sobre un espacio topológico $X$ es un prehaz sobre $X$ que satisface las siguientes propiedades
	    \begin{itemize}
	      \item \emph{localidad}: si tenemos un recubrimiento abierto $\mathcal{U}$ de un abierto $U\subset X$ y dos secciones $s_1, s_2 \in \FF(U)$ tales que $s_1 |_V= s_2|_V$ para todo $V \in \mathcal{U}$, entonces $s_1=s_2$.
	      \item \emph{pegado}: si tenemos un recubrimiento abierto $\mathcal{U}$ de un abierto $U\subset X$ y, para cada $V \in \mathcal{U}$ tenemos una sección $s_V \in \FF(V)$ tal que 
		\begin{equation*}
		  s_V|_{V\cap W}=s_W|_{V\cap W},
		\end{equation*}
		para cualesquiera $V, W \in \mathcal{U}$, entonces existe una sección $s\in \FF(U)$ tal que $s|_V=s_V$ para todo $V \in \mathcal{U}$.
	    \end{itemize}
	  \end{defn}

	  \begin{defn}
	    Un \emph{subhaz} de un haz $\FF$ sobre un espacio topológico es un haz $\mathscr{G}$ tal que $\mathscr{G}(U) \subset \mathscr{F}(U)$ para todo $U$ abierto de $X$. 
	  \end{defn}

	  \begin{defn}
	    Una $C^\infty$\emph{-variedad} es un par $(M,C^\infty_M)$, donde $M$ es una variedad topológica y $C^\infty_M$ es un subhaz del haz $C(M)$ de forma que, para todo punto $x\in M$ existe una carta $(U,\varphi)$ en $x$ tal que la aplicación
	    \begin{align*}
	      \varphi^* :C^{\infty}(\varphi(U))&\longrightarrow C^\infty_M(U)\\ 
	      s &\longmapsto s\circ \varphi 
	      \end{align*}
	      es biyectiva.
	  \begin{center}
	    \begin{tikzcd}
	      M \supset U \arrow{rr}{s\circ \varphi} \arrow{dd}{\varphi}  &&\RR	      \\ 
	      \\
	      \RR^n \supset \varphi(U). \arrow{rruu}{s}
	    \end{tikzcd}
	  \end{center}

	  El haz $C^\infty_M$ se denomina \emph{haz de funciones diferenciables} o \emph{haz de estructura} de $M$.
	  \end{defn}

	  \begin{defn}
	    Un $C^\infty$\emph{-morfismo} entre dos $C^\infty$-variedades $(M,C^\infty_M)$ y $(N,C^\infty_N)$ es una aplicación continua $f:M\rightarrow N$ 
	      tal que, si $V \subset N$, es un abierto, entonces existe una aplicación
	      \begin{align*}
		f^*_V : C^\infty_N(V) &\longrightarrow C^\infty_M(f^{-1}(V)) \\ 
		  s &\longmapsto s\circ f. 
		\end{align*}
		
	  \begin{center}
	    \begin{tikzcd}
	      M \supset f^{-1}(V) \arrow{rr}{s\circ f} \arrow{dd}{f}  &&\RR	      \\ 
	      \\
	     N \supset V. \arrow{rruu}{s}
	    \end{tikzcd}
	  \end{center}
	  \end{defn}

	  Estas definiciones nos permiten considerar una nueva categoría $C^\infty\mathbf{-Man}$ cuyos objetos son las $C^\infty$-variedades y sus morfismos son los $C^\infty$-morfismos.

	  \begin{prop}\label{equiv1}
	    Existe una equivalencia de categorías 
	    \begin{align*}
	      \mathbf{Diff}&\longrightarrow C^{\infty}\mathbf{-Man}.
	      \end{align*}
	  \end{prop}

	  \begin{proof}
	    En primer lugar, debemos definir el funtor que nos dará la equivalencia de categorías. A cada variedad diferenciable $(M,\mathcal{U}_M)$ es necesario asignarle una $C^\infty$-variedad $(M,\mathscr{F}_M)$. Claramente, a la variedad topológica le asociaremos ella misma. Podemos definir un prehaz a partir de $\mathcal{U}_M$ de la siguiente manera. Para cada $U\subset M$ tal que existe un sistema de coordenadas $\varphi$ tal que $(U,\varphi)\in \mathcal{U}_M$ consideramos el conjunto
	    \begin{equation*}
	      C^\infty_M (U) = \left\{ f \circ \varphi : f \in C^{\infty}(\varphi(U))  \right\}.
	    \end{equation*}
	    Si $U$ no es un dominio de coordenadas del altas $\mathcal{U}_M$, entonces existe un conjunto de dominios de coordenadas $\mathcal{V}\subset \mathcal{U}_M$ tal que $U=\bigcup_{V\in \mathcal{V}} V$ y puedo considerar
	    \begin{equation*}
	      C^\infty_M (U) = \left\{f \in C(U) : f|_{V} \in C^\infty_M(V) \text{ para todo } V\in \mathcal{V}  \right\}.
	    \end{equation*}
	    Es inmediato que esta asignación $C^\infty_M$ así definida es, de hecho un haz sobre $M$.

	    En cuanto a los morfismos, si $f:M \rightarrow N$ es una aplicación diferenciable, su $C^\infty$-morfismo asociado es simplemente la propia aplicación $f$, que claramente induce una aplicación de la forma
	      \begin{align*}
		f^*_V : C^\infty_N(V) &\longrightarrow C^\infty_M(f^{-1}(V)) \\ 
		  s &\longmapsto s\circ f, 
		\end{align*}
		con $V\subset N$ abierto.

		Tenemos que probar entonces
		\begin{enumerate}
		  \item que el funtor es esencialmente sobreyectivo, es decir, que toda $C^\infty$-variedad puede obtenerse de esta manera, y
		  \item que el funtor es plenamente fiel, es decir, que, dadas dos variedades diferenciables $M$ y $N$, existe una biyección entre las aplicaciones diferenciables entre $M$ y $N$ y los $C^\infty$-morfismos entre las $C^\infty$-variedades asociadas.
		\end{enumerate}

		    Veamos 1. Sea $(M,C^\infty_M)$ una $C^{\infty}$-variedad. Para cada punto $x\in M$ consideremos la carta $(U_x,\varphi_x)$ que aparece en la definición de $C^{\infty}$-variedad y definimos el conjunto
		    \begin{equation*}
		      \mathcal{U}_M=\left\{ (U_x,\varphi_x): x\in M \right\}.
		    \end{equation*}
		    Veamos que $\mathcal{U}_M$ es un atlas en $M$. Dadas dos cartas $(U_1,\varphi_1), (U_2,\varphi_2) \in \mathcal{U}_M$, con $U_1 \cap U_2 \neq \varnothing$, tenemos que ver que $\varphi_2 \circ \varphi_1^{-1}$ es un difeomorfismo. La biyectividad está clara, así que basta ver que tanto ella como su inversa son diferenciables. Tan solo probaremos la diferenciabilidad de ella, ya que para la de su inversa la demostración es análoga. Para ver esto, basta considerar las funciones coordenadas
		    \begin{align*}
		      \pr_i :\varphi_2(U_2)&\longrightarrow \RR\\ 
		        (y^1,\dots,y^n) &\longmapsto y^i, 
		      \end{align*}
		      para cada $i=1,\dots,n$, con $n=\dim M$ (en la componente conexa que corresponda). Estas aplicaciones son claramente diferenciables, es decir, $\pr_i \in C^{\infty}(\varphi_2(U_2))$. Pero $\pr_i = \pr_i \circ \varphi_2 \circ \varphi_2^{-1}$, luego $\pr_i \circ \varphi_2 \in C^\infty_M(U_2)$ y, por ser prehaz, $\pr_i \circ \varphi_2|_{U_1 \cap U_2} \in C^\infty_M(U_1 \cap U_2)$. Pero, de nuevo, por la definición de $C^{\infty}$-variedad, $\pr_{i} \circ \varphi_2 \circ \varphi_1^{-1} \in C^\infty_M(\varphi_1(U_1 \cap U_2))$. Por tanto, $\varphi_2 \circ \varphi_1^{-1}$ es diferenciable coordenada a coordenada, luego es diferenciable. Tenemos entonces que $\mathcal{U}_M$ es un atlas en $M$ y, tomando el maximal que lo contiene, dotamos a $M$ de una estructura diferenciable.

		      Finalmente, veamos 2. La inyectividad está clara ya que aplicaciones diferenciables distintas $M\rightarrow N$ inducen $C^{\infty}$-morfismos distintos. Basta ver entonces que, si $f:M\rightarrow N$ es un $C^{\infty}$-morfismo, entonces es una aplicación diferenciable respecto de la estructura diferenciable que acabamos de construir.		      En efecto, si $x\in M$ es un punto y $(V,\psi)$ es una carta de $N$ en $f(x)$ como la de la definición de $C^{\infty}$-variedad, entonces, para $i=1,\dots,n$, con $n=\dim N$, $\pr_i=(\pr_i\circ \psi)\circ \psi^{-1}$ es una función diferenciable en $\psi(V)$, es decir $\pr_i \in C^\infty(\psi(V)$, luego $\pr_i \circ \psi \in C^\infty_N (V)$. Ahora, por ser $f$ un $C^\infty$-morfismo, $f^*_V(\pr_i \circ \psi)=\pr_i \circ \psi \circ f \in C^\infty_M(f^{-1}(V))$. Si tomamos ahora una carta $(U,\varphi)$ de $M$ en $x$ como la de la definición de $C^\infty$-variedad y tal que $U \subset f^{-1}(V)$, entonces $\pr_i \circ \psi \circ f \in C^\infty_M(U)$, luego $\pr_i \circ \psi \circ f \circ \varphi^{-1} \in C^\infty (\varphi(U))$. Hemos visto entonces que, para cada punto $x\in M$ existen cartas $(U,\varphi)$ y $(V,\psi)$ en $M$ y $N$ respectivamente, con $f(U)\subset V$ y tales que cada componente de la localización (y por tanto, la localización) $\psi \circ f \circ \varphi^{-1}$ es diferenciable, luego, por la definición de aplicación diferenciable, $f$ es diferenciable.  
	  \end{proof}

	  Más aún, podemos probar que podemos recuperar toda la información sobre la variedad a partir del conjunto de sus funciones diferenciables:
	  \begin{prop}
 Sea $M$ una variedad diferenciables y $C^\infty(M):=C_M^\infty(M)$ la $\RR$-álgebra de funciones diferenciables $M\rightarrow \RR$.  La aplicación
  \begin{align*}
    M&\longrightarrow C^{\infty}(M)^*\\ 
    x &\longmapsto \bar{x}, 
    \end{align*}
    con
    \begin{align*}
      \bar{x} :C^{\infty}(M)&\longrightarrow \RR\\ 
        f &\longmapsto f(x),
      \end{align*}
      es biyectiva.
\end{prop}
\begin{proof}\leavevmode

  Sean $x,y \in M$, $x\neq y$. Para probar la inyectividad basta tomar una función separante $\theta\in C^{\infty}(M)$ tal que $\theta(x)=1$ y $\theta(y)=0$. 

  Sea ahora $\xi: C^{\infty}(M)\rightarrow \RR$. Tomemos una función $f\in C^{\infty}(M)$ propia [apéndice] y llamemos $\lambda=\xi(f)$. Supongamos que para ningún $x\in f^{-1}(\lambda)$ se tiene que $\bar{x}=\xi$. Entonces existe una familia de funciones $\left\{ f_x: x\in f^{-1}(\lambda) \right\}$ tal que $f_x(x)\neq \xi (f_x)$. Consideramos entonces un recubrimiento de $f^{-1}(\lambda)$ por la familia de abiertos $\left\{ U_x : x\in f^{-1}(\lambda) \right\}$, con $$U_x= \left\{ y\in M:f_x(y)\neq \xi(f_x) \right\}.$$
  Como $f^{-1}(\lambda)$ es compacto, existe un subrecubrimiento finito $U_{x_1},\dots,U_{x_m}$. Podemos definir entonces la función
  \begin{equation*}
    g=(f-\lambda)^{2}+\sum_{k=1}^m(f_{x_k}-\xi(f_{x_k}))^2,
  \end{equation*}
  que no se anula en ningún punto de $f^{-1}(\lambda)$, por lo que la función $1/g$ está bien definida en todo este conjunto. Ahora,
  \begin{equation*}
    \xi(g)=(\xi(f)-\lambda)^2+\sum_{k=1}^m(\xi(f_{x_k})-\xi(f_{x_k}))^2=0,
  \end{equation*}
  mientras que, como $\xi$ es un homomorfismo de álgebras, $\xi(1)=1$. Sin embargo,
  \begin{equation*}
    \xi(1)=\xi\left(g\cdot \frac{1}{g}\right)=\xi(g) \times \xi\left(\frac{1}{g}\right)=0,
  \end{equation*}
  y llegamos a una contradicción. Por tanto, debe existir un $x\in f^{-1}(\lambda)$ tal que $\bar{x}=\xi$.
\end{proof}

\begin{corol}
  El funtor
  \begin{align*}
    C^{\infty}:\mathbf{Diff} &\longrightarrow  \mathbf{Alg}_\RR^{op}\\ 
    M &\longmapsto  C^{\infty}(M)\\
    f\in \mathbf{Diff}(M,N) &\longmapsto  f^{*}\in \mathbf{Alg}_\RR(C^{\infty}(N),C^{\infty}(M)),\\
    \end{align*}
    con
    \begin{equation*}
      f^*\varphi=\varphi \circ f \in C^{\infty}(M),
    \end{equation*}
    para $\varphi \in C^{\infty}(N)$, es plenamente fiel.
  \end{corol}
\begin{proof}
  Hay que probar que, para cualesquiera $M$ y $N$ variedades diferenciables, la aplicación $f\mapsto f^*$ es biyectiva. 

  Veamos en primer lugar que es inyectiva. Dadas dos funciones $f,g:M\rightarrow N$, si $f\neq g$ entonces debe existir al menos un punto $x\in M$ tal que $f(x)\neq g(x)$. Tomando entonces una función $\varphi:N\rightarrow \RR$ tal que $\varphi(f(x))=1$ y $\varphi(g(x))=0$ (por ejemplo, una función meseta), tenemos
  \begin{align*}
    f^*\varphi (x)&= \varphi \circ f (x) = 1, \\
    g^*\varphi (x)&= \varphi \circ g (x) = 0,
  \end{align*}
  luego $f^* \neq g^*$.

  Veamos ahora la sobreyectividad. Sea un homomorfismo de $\RR$-álgebras $\xi:C^{\infty}(N)\rightarrow C^{\infty}(M)$. Tomemos un punto $x\in M$ y consideremos el homomorfismo 
  \begin{align*}
    \bar{x} :C^{\infty}(M)&\longrightarrow \RR\\ 
      f &\longmapsto f(x). 
    \end{align*}
    Tenemos entonces que $\bar{x} \circ \xi: C^{\infty}(N) \rightarrow \RR$ es un homomorfismo de $\RR$-álgebras, luego $\bar{x}\circ \xi \in C^{\infty}(N)^*$ y, en virtud de la proposición, le corresponde un único $y \in N$ tal que $\bar{y}=\bar{x} \circ \xi$, con 
  \begin{align*}
    \bar{y} :C^{\infty}(N)&\longrightarrow \RR\\ 
      g &\longmapsto g(y). 
    \end{align*}
    Es decir, para cada $x \in M$ podemos considerar el punto $y_x \in N$ tal que el siguiente diagrama conmuta
    \begin{center}
      \begin{tikzcd}
	C^{\infty}(N)	\arrow{r}{\xi}\arrow{rd}[anchor=north,rotate=-30]{\bar{y_x}} & C^{\infty}(M)\arrow{d}[anchor=west]{\bar{x}} \\ 
	 &\RR,
       \end{tikzcd}
     \end{center}
     de modo que podemos definir la función $f_{\xi}:M\rightarrow N$ tal que $f_{\xi}(x)=y_x$, para cada $x\in M$.

\end{proof}
\begin{obs}
Nótese que estos últimos resultados son muy particulares de la categoría diferenciable, ya que en el corazón de la prueba están las particiones diferenciables de la unidad. Por tanto, no podemos esperar un resultado similar en otras categorías como la holomorfa o la analítica. De hecho, se puede probar que las únicas funciones holomorfas globalmente definidas en una variedad compleja compacta son las constantes.
\end{obs}

    \section{Variedades sumergidas}
    \begin{defn}\label{difsumergida}
      Sean $X \subset \RR^n$, $Y\subset \RR^m$ dos conjuntos. Una aplicación $f:X\rightarrow Y$ se dice \emph{diferenciable} si existen dos abiertos $U \subset \RR^n$ y $V \subset \RR^m$, con $X\subset U$ e $Y \subset V$ y una aplicación diferenciable $F:U \rightarrow V$ tal que el siguiente diagrama conmuta
      \begin{center}
	\begin{tikzcd}
U	  \arrow{r}{F} & V \\ 
	   X\arrow{r}[anchor=south]{f} \arrow[hook]{u}& Y.\arrow[hook]{u}
	 \end{tikzcd}
       \end{center}
       Análogamente, decimos que $f$ es un difeomorfismo si es biyectiva y su inversa es diferenciable (en el mismo sentido que acabamos de definir).
    \end{defn}
    \begin{defn}
      Un subconjunto $M\subset \RR^p$ se llama una \emph{subvariedad regular} de $\RR^p$ o una \emph{variedad diferenciable sumergida} en $\RR^p$ si es localmente difeomorfo a un abierto de un espacio afín. Es decir, para todo $x\in M$ existe un entorno abierto $U \subset \RR^p$ de $x$, un abierto $V \subset \RR^n$, para cierto $n\in \NN$ y un difeomorfismo $\varphi: U \cap M \rightarrow V$. 
    \end{defn}

    Nótese que todo subconjunto $M\subset \RR^p$ se puede dotar de la topología relativa: los abiertos de $M$ son los conjuntos de la forma $U \cap M$, con $U \subset \RR^p$ abierto de $\RR^p$. Por tanto, si $M$ es una subvariedad regular de $\RR^p$, entonces es una variedad topológica con la topología relativa y, para cada $x\in M$ tenemos una carta $\varphi_x: U_x \cap M \rightarrow V \subset \RR^n$. De hecho, como las cartas $\varphi$ son difeomorfismos, los cambios de coordenadas $\varphi_2 \circ \varphi_1^{-1}$ también son difeomorfismos, luego las cartas son compatibles y forman un atlas. Tenemos entonces que toda subvariedad regular es una variedad diferenciable. 

    Los ejemplos no triviales más simples de variedades sumergidas vienen dados por el teorema de la función implícita: 
    \begin{prop}[Teorema de la función implícita]
    Sean $U\subset \RR^p$ un conjunto abierto y $F: U \rightarrow \RR^q$ una aplicación diferenciable. Supongamos que existe un punto $a\in U$ en el que $d_a F$ es sobreyectiva. Entonces existe un entorno abierto $B\subset U$ de $a$ tal que
    \begin{equation*}
      M=\left\{ x\in B: F(x)=F(a) \right\},
    \end{equation*}
    es una subvariedad regular de $\RR^p$ de dimensión $p-q$.
    \end{prop}
    \begin{proof}
      Como $d_a F:\RR^p \rightarrow \RR^q$ es sobreyectiva, $p>q$ y $\dim \ker d_a F =p-q$, luego existe un isomorfismo lineal $\psi:\ker d_a F \rightarrow \RR^{p-q}$ que nos permite definir una aplicación lineal sobreyectiva $g:\RR^p \rightarrow \RR^{p-q}$ por
      \begin{equation*}
	g(x)=
	\begin{cases}
	  \psi(x) & \text{ si } x \in \ker d_aF \\
	  0 & \text{ en caso contrario.}
	\end{cases}
      \end{equation*}
      Definimos entonces
      \begin{align*}
	h :U&\longrightarrow \RR^p=\RR^q \times \RR^{p-q}\\ 
	  x &\longmapsto (F(x),g(x)). 
	\end{align*}
	Ahora, $d_a h=(d_a F, g):\RR^p \rightarrow \RR^p$ es inyectiva ya que si $d_a h (\ve{u})=0$ entonces $d_a F(\ve{u})=0$, luego $\ve{u}\in \ker d_a F$. Pero entonces $g(\ve{u})=\psi(\ve{u})=0$ si y sólo si $\ve{u}=0$, ya que $\psi$ es un isomorfismo lineal. Por tanto, $d_a h$ es un isomorfismo lineal y, por el teorema de la función inversa, existen un entorno $B\subset U$ de $a$ y un entorno $V\subset \RR^p$ de $h(a)=(F(a),g(a))$ tales que $h:B\rightarrow V$ es un difeomorfismo. Finalmente, $M$ es difeomorfo a $h(M)=(\left\{ f(a) \right\}\times \RR^{p-q}) \cap V\subset \RR^p$, que es claramente una subvariedad regular de dimensión $p-q$. 
    \end{proof}

    \begin{ejemplo}
      Un ejemplo muy sencillo de subvariedad regular dada por el teorema de la función implícita es la esfera. En efecto, consideramos la función
      \begin{align*}
	F :\RR^{n+1}&\longrightarrow \RR\\ 
	(x^1,\dots,x^{n+1}) &\longmapsto (x^1)^2+\dots+(x^n)^2. 
	\end{align*}
	La derivada de $F$ en un punto $a\in \RR^{n+1}$ es
	\begin{align*}
	  d_aF :\RR^{n+1}&\longrightarrow \RR\\ 
	  \ve{u} &\longmapsto 2 \esc{a,\ve{u}},
	  \end{align*}
	  que es sobreyectiva si $a\neq 0$.
	  Por tanto, la \emph{esfera $n$-dimensional de radio $\sqrt{F(a)}$},
	  \begin{equation*}
	    \SF^{n}_{\sqrt{F(a)}}=\left\{ x \in \RR^{n+1}: F(x)=F(a) \right\},    
	  \end{equation*}
	  es una subvariedad regular de $\RR^p$ de dimensión $n$. En el caso que $F(a)=1$ (es decir, si $\norm{a}=1$) la denotamos $\SF^n$ y la llamamos simplemente \emph{esfera $n$-dimensional}. Claramente, todas las esferas de la misma dimensión son difeomorfas, basta considerar la homotecia
	  \begin{align*}
	     \SF^n_r&\longrightarrow \SF^n\\ 
	     x &\longmapsto \frac{x}{r}. 
	    \end{align*}
      \qed
    \end{ejemplo}

    Las aplicaciones diferenciables entre dos subvariedades regulares $M \subset \RR^p$ y $N \subset \RR^q$ son simplemente aplicaciones diferenciables $M\rightarrow N$ en el sentido de la Definición \ref{difsumergida}. Así, podemos considerar una nueva categoría, que llamaremos $\mathbf{RegMan}$ cuyos objetos son las subvariedades regulares y sus morfismos, las aplicaciones diferenciables entre ellas.
    
    Nótese también que, en el caso de las subvariedades regulares, podemos dotar a $M\subset \RR^p$ de un haz de funciones diferenciables de manera trivial: como los abiertos de $M$ son de la forma $U\cap M$, con $U\subset \RR^p$ abierto, consideramos simplemente
    \begin{equation*}
      C^\infty_M (U \cap M)= \left\{U\cap M \rightarrow \RR \text{ diferenciables}\right\},
    \end{equation*}
    donde la diferenciabilidad se entiende en el sentido de la definición \ref{difsumergida}.
    Claramente, como $M$ es una subvariedad regular, para todo punto $x\in M$ existe un abierto $U \subset \RR^p$ y un difeomorfismo $\varphi:U\cap M \rightarrow V$, con $V\subset \RR^n$ abierto, para cierto $n\in \NN$. Pero entonces, la aplicación
    \begin{align*}
      \varphi_* :C^{\infty}_M(U\cap M)&\longrightarrow C^\infty(V)\\ 
      s &\longmapsto s\circ \varphi^{-1}, 
      \end{align*}
      es biyectiva y $(M,C^\infty_M)$ es una $C^\infty$-variedad.

    Hemos visto que toda subvariedad regular es una variedad diferenciable, pero el recíproco también es cierto. El teorema de inmersión de variedades abstractas garantiza que toda variedad diferenciable $M$ es difeomorfa a alguna subvariedad regular $\hat{M} \subset \RR^p$, para algún $p\in \NN$. Esto nos permite demostrar el siguiente teorema:

    \begin{prop}
      Existe una equivalencia de categorías
      \begin{align*}
	\mathbf{Diff}&\longrightarrow \mathbf{RegMan}.
	\end{align*}
    \end{prop}
    \begin{proof}
      Si $M$ es una variedad diferenciable denotamos $\hat{M} \subset \RR^p$ y $\varphi_M:M \rightarrow \hat{M}$ la subvariedad regular y el difeomorfismo dados por el teorema de inmersión de variedades abstractas. Podemos definir un funtor que asigne, a cada variedad diferenciable $M$, la subvariedad regular $\hat{M}$ y, a cada aplicación diferenciable $f:M \rightarrow N$, la aplicación $\hat{f}:\hat{M} \rightarrow \hat{N}$ que cierra el diagrama
      \begin{center}
	\begin{tikzcd}
M	  \arrow{r}{f}\arrow{d}[anchor=east]{\varphi_M} & N\arrow{d}[anchor=west]{\varphi_N} \\ 
	   \hat{M}\arrow{r}[anchor=south]{\hat{f}} & \hat{N}.
	 \end{tikzcd}
       \end{center}
       La funtorialidad es inmediata y la asignación entre morfismos es claramente biyectiva por ser $\varphi_M$ y $\varphi_N$ difeomorfismos. Por tanto, el funtor es plenamente fiel. Que es esencialmente sobreyectivo es inmediato también porque toda subvariedad regular $M$ es ya una variedad diferenciable, es decir $M=\hat{M}$. Por tanto, tenemos una equivalencia de categorías.
    \end{proof}

    En resumen, a lo largo de este capítulo hemos definido tres categorías: $\mathbf{Diff}$, $C^\infty\mathbf{-Man}$ y $\mathbf{RegMan}$, que han resultado ser equivalentes. Es decir, las tres categorías representan el mismo concepto matemático: espacios localmente modelados por $\mathbf{CartSp}$, o sea, espacios donde se puede hacer cálculo diferencial. A la vista de esto, a lo largo del texto, trabajaremos con las tres categorías indistintamente: una variedad diferenciable significará para nosotros un objeto de alguna de estas tres categorías, según nos sea conveniente.



	  \section{Variedades con borde}
	  Para terminar el capítulo, vamos a considerar una clase de objetos ligeramente más general que las variedades diferenciables. En esta clase queremos incluir objetos que puedan «tener borde». Intuitivamente estamos pensando en objetos como un semiplano que contiene a la recta delimitante, discos con frontera, cilindros, bandas, etc. 

	En este caso el modelo local son los abiertos $U$ del \emph{semiespacio cerrado}
	\begin{equation*}
	  \HH^n = \left\{ (x^1,\dots,x^n) \in \RR^n : x^1 \geq 0 \right\},
	\end{equation*}
	cuyo \emph{borde} es simplemente la frontera topológica
	\begin{equation*}
	  \partial \HH^n = \left\{ (x^1,\dots,x^n) \in \RR^n: x^1=0 \right\}.
	\end{equation*}

	\begin{prop}[Invariancia diferenciable del borde]\label{borde}
	Sean dos abiertos $U\subset \HH^n$, $V\subset \HH^n$ y un difeomorfismo $f:U\rightarrow V$. Entonces $f(U\cap \partial \HH^n)= V \cap \partial \HH^n$.
	\end{prop}
	\begin{proof}
	  Probamos uno de los contenidos, el otro es análogo considerando $f^{-1}$, ya que $f$ es un difeomorfismo. Supongamos que existe un punto $x\not \in U\cap \partial \HH^n$ tal que $f(x) \in V\cap \partial \HH^n$. Como $x$ está en el interior de $U$, entonces existe un $\eps >0$ tal que la bola $B_\eps (x) \subset U$. Por tanto, para cualquier vector unitario $\ve{u}\in \RR^n$, la imagen de la curva $\gamma(t)=x+t\ve{u}$ está contenida en $U$ si $t\in (-\eps,\eps)$. Podemos considerar entonces una aplicación $g:\RR\rightarrow \RR$ que a cada tiempo $t$ nos diga «a qué altura» se encuentra la imagen por $f$ de $\gamma(t)$ del borde. Es decir, definimos la aplicación $g=\pr_1 \circ f \circ \gamma$, cuya derivada es simplemente 
	  \begin{equation*}
	    g'(t)=\esc{\nabla f_1(x+t\ve{u}),\ve{u}},
	  \end{equation*}
	  donde $f=(f_1,\dots,f_n)$ y hemos aplicado la regla de la cadena. Ahora, como $f(y) \in \HH^n$ para todo $y\in U$, $\pr_1(f(y))\geq 0$ y, como $f(x)\in \partial \HH^n$, $\pr_1(f(x))=0$, luego $g$ alcanza un mínimo local en $t=0$. Por tanto, $g'(0)=0$, luego $\esc{\nabla f_1(x), \ve{u}}$. Como esto es cierto para todos los vectores unitarios $\ve{u}$, tenemos que $\nabla f_1(x)=0$, lo que contradice que $f$ es un difeomorfismo.
	\end{proof}



	Por el buen comportamiento de la derivada en la frontera, el cálculo diferencial se puede generalizar fácilmente a esta nueva clase de espacios, lo que nos permite considerar una nueva clase de variedades.
	\begin{defn}
	  Una \emph{variedad topológica con borde} es un espacio topológico $M$ Hausdorff y segundo axioma de numerabilidad que es localmente homeomorfo a un abierto de un semiespacio cerrado. Es decir, para todo $x\in M$ existe un entorno abierto $U\subset M$ de $x$, un abierto $V\subset \HH^n$ para cierto $n\in \NN$ y un homeomorfismo $\varphi:U\rightarrow V$. El par $(U,\varphi)$ se llama una \emph{carta} de $M$ en $x$.

	  Una variedad topológica con borde es una \emph{variedad diferenciable con borde} si, para todo punto $x\in M$ y para cualesquiera dos cartas $(U_1,\varphi_1)$, $(U_2,\varphi_2)$, el cambio de coordenadas $(\varphi_2 \circ \varphi_1^{-1})|_{\varphi_1(U_1\cap U_2)}$ es un difeomorfismo. El \emph{borde} de $M$, que se denota $\partial M$, es el conjunto de los puntos que corresponden por cartas a puntos del borde del semiespacio cerrado.
	\end{defn}

	El hecho de que los cambios de coordenadas sean difeomorfismos junto con la Proposición \ref{borde} garantizan que el que un punto esté en el borde no depende de la elección de cartas. Es inmediato comprobar que el borde $\partial M$ de una variedad diferenciable $M$ de dimensión $n$ es una variedad diferenciable sin borde de dimensión $n-1$.

	  \chapter{El espacio tangente}
	  \section{El espacio tangente a una variedad sumergida}
	  Sean $M\subset \RR^p$ una subvariedad regular de dimensión $n$, $x\in M$ y $(U,\varphi)$ una carta en $x$. La aplicación $\psi=\varphi^{-1}$ se dice que es una \emph{parametrización local} de $M$ por el dominio de coordenadas $U$. Si llamamos $V=\varphi(U)$ y $a=\varphi(x)$, esta parametrización es una aplicación diferenciable $\psi:V\rightarrow \RR^p$, de modo que tiene una derivada en $a$, que es una aplicación lineal $d_a\psi:\RR^n \rightarrow \RR^p$. La imagen de esta aplicación lineal no depende de la parametrización ya que, si $\bar{\psi}:W \rightarrow \RR^p$ es otra parametrización y llamamos $b=\psi^{-1}(x)$, entonces
	  \begin{equation*}
	    d_a(\bar{\psi}^{-1}\circ \psi)=(d_b \bar{\psi})^{-1} \circ d_a \psi.
	  \end{equation*}
	  De modo que
	  \begin{equation*}
	    d_a \psi=(d_b \bar{\psi})\circ d_a(\bar{\psi}^{-1}\circ \psi)
	  \end{equation*}
	  y, como $d_a(\bar{\psi}^{-1}\circ \psi)$ es un isomorfismo lineal (ya que el cambio de coordenadas es un difeomorfismo) entonces $d_a\psi$ y $d_b\tilde{\psi}$ deben tener la misma imagen.
	  Así, sin pérdida de generalidad podemos definir el \emph{espacio tangente a $M$ en $x$} como $T_xM = \im(d_a\psi)$. Los elementos $\ve{u}\in T_xM$ se llaman \emph{vectores tangentes a $M$ en $x$}. Además, como las derivada de $\psi$ es inyectiva, este espacio tangente es un espacio vectorial de dimensión $n=\dim M$.

	  Un vector $\ve{u} \in T_xM = \im(d_a \psi)$ es de la forma 
	  \begin{equation*}
	    \ve{u}=
	    \left(
	    \begin{array}{ccc}
	      \frac{\partial \psi^1}{\partial x^1}(a) & \cdots & \frac{\partial \psi^1}{\partial x^n}(a)\\
	      \vdots & \vdots & \vdots \\
	      \frac{\partial \psi^p}{\partial x^1}(a) & \cdots & \frac{\partial \psi^p}{\partial x^n}(a)
	    \end{array}
	    \right)
	    \left( 
	    \begin{array}{c}
	      u^1 \\
	      \vdots \\
	      u^n 
	    \end{array}
	    \right),
	  \end{equation*}
	  donde $\psi=(\psi^1,\dots,\psi^p)$ es la expresión en componentes de $\psi$ y $u^1,\dots,u^n\in \RR^n$. Es decir, los vectores
	  \begin{equation*}
	    \frac{\partial \psi}{\partial x^i}(a) := \left( \frac{\partial \psi^1}{\partial x^i}(a),\dots,\frac{\partial \psi^p}{\partial x^i}(a) \right) 
	  \end{equation*}
	  forman una base del espacio tangente $T_xM$ y podemos escribir $\ve{u}=\sum_i u^i\frac{\partial \psi}{\partial x^i}(a)$.

	  Otra forma «dual» de obtener el espacio tangente en ciertos casos es por medio del teorema de la función implícita. Consideremos un abierto $U\subset \RR^p$ y una aplicación diferenciable $F:U\rightarrow \RR^q$. Si tenemos un punto $a\in U$ en el que $d_aF$ es sobreyectiva tenemos un difeomorfismo local $h:U\rightarrow \RR^p$ que transforma, en un entorno $B$ de $a$, el conjunto 
	  \begin{equation*}
M=	    \left\{ x\in B: F(x)=F(a) \right\}
	  \end{equation*}
	  en $\left\{ F(a) \right\}\times \RR^{p-q}$. Vimos además que $d_ah=(d_aF, g)$, de modo que, si consideramos la parametrización $h^{-1}$,
	  \begin{equation*}
	    T_aM=\im d_{h(a)} (h^{-1}) = (d_{a}h)^{-1}(\left\{ 0 \right\}\times \RR^{p-q}) = \ker d_a F.
	  \end{equation*}

	  \begin{ejemplo}
	    Volviendo al ejemplo de la esfera $\SF^n=\left\{ x\in \RR^{n+1}: \norm{x} =1 \right\}$. Llamando $F(x)=\norm{x}^2$, vimos que la derivada de $F$ en un punto $a\in \RR^{n+1}$ es $d_aF(\ve{u})=2\esc{a,\ve{u}}$. Tenemos entonces que, si $\norm{a}=1$,
	    \begin{equation*}
	      T_a \SF^n = \ker d_a F = \left\{ \ve{u} \in \RR^{n+1}: \esc{a,\ve{u}}=0 \right\}.
	    \end{equation*}
	    Es decir, los vectores tangentes a $\SF^n$ en un punto $a$ son precisamente los perpendiculares al radio vector que une el origen con $a$.
	    \qed
	  \end{ejemplo}

	  Finalmente, podemos definir la \textit{derivada} de una aplicación diferenciable entre subvariedades regulares. Sean $M\subset \RR^p$ y $N\subset \RR^q$ subvariedades regulares y $f:M\rightarrow N$ una aplicación diferenciable. Por definición, existen dos abiertos $U\subset \RR^p$ y $V\subset \RR^q$ y una extensión $F:U\rightarrow V$ diferenciable de $f$. Si tomamos un punto $x\in M$ y escogemos los abiertos $U$ y $V$ tales que $(U\cap M,\varphi)$ y $(V\cap M,\psi)$ son cartas en $x$ y en $f(x)$, respectivamente, podemos considerar la localización $\tilde{f}=\psi\circ f \circ \varphi^{-1}$. Esta localización es una aplicación diferenciable que cumple $F \circ \varphi^{-1} =\psi^{-1}\circ \tilde{f}$ luego, por la regla de la cadena, 
	  \begin{equation*}
	    d_x F \circ (d_{x}\varphi)^{-1} = (d_{f(x)}\psi)^{-1} \circ d_{\varphi(x)}\tilde{f}.
	  \end{equation*}
	  Ahora, $\im (d_{x}\varphi)^{-1} = T_xM$ e $\im (d_{f(x)}\psi)^{-1}=T_{f(x)}N$, por tanto, tenemos que $$d_xF(T_xM)\subset T_{f(x)}N.$$ Además, 
	  \begin{equation*}
	    d_xF|_{T_xM}= (d_{f(x)}\psi)^{-1}\circ d_{\varphi(x)}\tilde{f} \circ d_x \varphi,
	  \end{equation*}
	  que no depende de la extensión $F$. Por tanto, podemos definir 
	  \begin{align*}
	    d_xf=d_xF|_{T_x M}:T_xM&\longrightarrow T_{f(x)}N 
	    \end{align*}
	   la \emph{derivada de $f$ en $x$}.
	  \section{Derivaciones}
	  Hemos definido el espacio tangente para variedades sumergidas, pero cabe preguntarse ahora si se puede hacer una construcción análoga para el caso de una variedad diferenciable cualquiera, en principio no sumergida. Esta construcción puede hacerse, usando el concepto de \textit{derivación} de un álgebra. La idea es considerar la variedad diferenciable como una $C^\infty$-variedad y tratar de estudiar el aspecto \textit{infinitesimal} del haz de estructura en un punto de la variedad. La manera de hacer este estudio es por medio de las \textit{espigas} del haz. 

	    Sea $\FF$ un prehaz sobre un espacio topológico $X$. Consideramos un punto $x\in X$ y el sistema directo de los entornos de $x$ respecto a la inclusión. Se define la \emph{espiga} de $\FF$ en $x$ como

	    \begin{equation*}
	      \FF_x = \varinjlim_{x\in U \subset M} \FF(U).
	    \end{equation*}

	    En el caso que nos incumbe, si $M$ es una variedad diferenciable de dimensión $n$ y $C^\infty_M$ denota su haz de funciones diferenciables, entonces la espiga de $C^\infty_M$ en un punto $x\in M$ es simplemente el conjunto de las funciones $f:M\rightarrow \RR$ que son diferenciables en algún entorno de $x$. Este conjunto se denota $C^\infty_{M,x}$ y se llama el \emph{álgebra de gérmenes de funciones diferenciables en $x$}. Cada conjunto $C^\infty_M(U)$ es una $\RR$-álgebra, donde las operaciones son simplemente la suma y el producto de funciones. Por tanto, las espigas $C^\infty_{M,x}$ también serán $\RR$-álgebras. 

	    \begin{defn}
	      Una \emph{derivación} en $x\in M$ es una aplicación lineal $D:C^\infty_{M,x} \rightarrow \RR$ que satisface la \emph{regla de Leibniz}:
	      \begin{equation*}
		D(fg)=f(x)D(g)+g(x)D(f),
	      \end{equation*}
	      para cualesquiera $f,g \in C^\infty_{M,x}$.
	      Llamamos \emph{espacio tangente a $M$ en $x$} al espacio vectorial $T_xM$ formado por las derivaciones en $x$.
	    \end{defn}

	    \begin{obs}
	      Si $f\in C^\infty_{M,a}$ es un germen de una función constante, entonces para cualquier derivación $D\in T_xM$, $D(f)=0$. En efecto, si $f\equiv c$, con $c$ una constante, por linealidad $D(f)=cD(1)$. Ahora, por la regla de Leibniz $D(1)=D(1\cdot 1)=2D(1)$, con lo que $D(1)=0$. 
	    \end{obs}

	    Como $M$ es una variedad diferenciable, podemos encontrar una carta $(U,\varphi)$ en $x$ tal que la aplicación 
	    \begin{align*}
	      \varphi^* :C^\infty(\varphi(U))&\longrightarrow C^\infty_M(U) \\ 
	      s &\longmapsto s \circ \varphi 
	      \end{align*}
	      es biyectiva. Claramente, esta aplicación es también un isomorfismo de álgebras, que en las espigas induce un isomorfismo entre $C^\infty_{M,x}$ y $C^{\infty}_{\varphi(x)}$. De modo que $T_xM$ es isomorfo al espacio $T_{\varphi(x)}\RR^n$ de las derivaciones en $\varphi(x)\in \RR^n$. Explícitamente, este isomorfismo está dado por $\varphi_{*,x}:T_xM \rightarrow T_{\varphi(x)}\RR^n$, de modo que, si $s\in C^\infty_{\varphi(x)}$ y $D\in T_xM$,
	      \begin{equation*}
		(\varphi_{*,x} D) (s) = D(s\circ \varphi).
	      \end{equation*}

	      \begin{prop}
		Sea un punto $a=(a^1,\dots,a^n)\in \RR^n$. Las aplicaciones
		\begin{align*}
		   \partial_i|_a:C^\infty_a&\longrightarrow \RR\\ 
		   f &\longmapsto \frac{\partial f}{\partial x^i}(a),
		  \end{align*}
		  con $i=1,\dots,n$, son derivaciones en $a$ y forman una base de $T_a \RR^n$. En consecuencia, $T_a \RR^n \cong \RR^n$.
	      \end{prop}

	      \begin{proof}
		Que son derivaciones es inmediato, puesto que la regla de Leibniz es simplemente la regla del producto de las derivadas. Veamos que son una base. 

		En primer lugar, tenemos que probar que son linealmente independientes, es decir, que si existe un vector $\ve{u}=(u^1,\dots,u^n)\in \RR^n$ tal que $\sum_i u^i \partial_i|_a =0$, entonces $\ve{u}=0$. Para ver esto, consideremos las proyecciones $\pr_j: \RR^n \rightarrow \RR$, para $j=1,\dots,n$. Entonces, $$0=\sum_i u^i \partial_i|_a (\pr_j)= \sum_i u^i \frac{\partial x^j}{\partial x^i}(a)= u_j.$$ Tenemos entonces que $u_j=0$ para todo $j=1,\dots,n$, es decir, $\ve{u}=0$.

		Veamos ahora que son un sistema de generadores. Si $f\in C^\infty_a$ es un germen de una función diferenciable, entonces existe un entorno $U$ de $a$ donde $f$ es diferenciable y donde podemos hacer un desarrollo de Taylor, si $x\in U$,
		\begin{equation*}
		  f(x)=f(a)+ \sum_i (x^i - a^i)\frac{\partial f}{\partial x^i}(a) + O(( x^i-a^i )^2).
		\end{equation*}
		Entonces, si $D\in T_a \RR^n$ es una derivación en $a$,
		\begin{equation*}
		  D(f)=D(f(a))+\sum_i D(x^i-a^i) \frac{\partial f}{\partial x^i}(a) + \sum_i (x^i-a^i)|_{x=a} D\left(\frac{\partial f}{\partial x^i}\right) + D(O( (x^i-a^i)^2 )).
		\end{equation*}
		Ahora, $(x^i-a^i)|_{x=a}=(a^i-a^i)=0$, mientras que, como $D$ es lineal, se comporta bien con los límites y 
		\begin{equation*}
		  D(O( (x^i-a^i)^2))=O(D( (x^i-a^i)^2))= O(2(x^i-a^i) (x^i-a^i)|_{x=a})=0.
		\end{equation*}
		Eliminando los términos que son derivaciones de constantes, obtenemos
		\begin{equation*}
		  D(f)=\sum_i D(x^i) \frac{\partial f}{\partial x_i}(a).
		\end{equation*}
		Por tanto, podemos escribir 
		\begin{equation*}
		  D=\sum_i D(x^i) \partial_i |_a,
		\end{equation*}
		con lo que las derivaciones $\left\{ \partial_1 |_a,\dots,\partial_n|_a \right\}$ generan $T_a \RR^n$.
	      \end{proof}

	      Tenemos entonces que el espacio tangente $T_xM$ a un punto $x$ en una variedad diferenciable $M$ es un espacio vectorial real de dimensión $n=\dim M$.

	  \section{Derivada de una aplicación diferenciable}
	  Veamos ahora cómo podemos definir la noción de derivada de una aplicación diferenciable entre dos variedades abstractas.

	  En primer lugar, consideremos el caso en que $M\subset \RR^p$ es una variedad sumergida y $f:M\rightarrow \RR$ es una función diferenciable. En tal caso la derivada de $f$ en un punto $x\in M$ es simplemente
	  \begin{equation*}
	    d_x f = d_{\varphi(x)} \tilde{f} \circ d_x\varphi:T_xM \rightarrow \RR,
	  \end{equation*}
	  donde $(U,\varphi)$ es una carta en $x$ y $\tilde{f}$ es la localización $\tilde{f}=f\circ \varphi^{-1}$. Ahora, un vector $\ve{u}\in T_xM$ es de la forma $\ve{u}=d_{\varphi(x)}\varphi^{-1}(u^1,\dots,u^n)$. Por tanto, si $(x^1,\dots,x^n)$ son coordenadas en $U$ tenemos que
	  \begin{equation*}
	    d_xf (\ve{u})=d_{\varphi(x)}\tilde{f} \circ d_x\varphi \circ d_{\varphi(x)}\varphi^{-1}(u^1,\dots,u^n)=d_{\varphi(x)}\tilde{f}(u^1,\dots,u^n)=\sum_i \frac{\partial \tilde{f}}{\partial x^i}(\varphi(x)) u^i.
	  \end{equation*}

	  Podemos intentar imitar esta construcción en una variedad diferenciable abstracta $M$. En este caso, consideramos una carta $(U,\varphi)$ en torno a un punto $x\in M$ y una función diferenciable $f\in C^\infty_M(U)$. Consideramos también la localización $\tilde{f}=f\circ \varphi^{-1}$. Si llamamos $a=\varphi(x)$ y tomamos $D$ una derivación en $x$, entonces $\varphi_{*,x} D=\sum_i u^i \partial_i|_a\in T_a \RR^n$ es una derivación en $a$ y  podemos definir, de manera análoga al caso de variedades sumergidas
	  \begin{equation*}
	    d_xf (D):=\sum_i \frac{\partial \tilde{f}}{\partial x^i}(a) u^i=\sum_i u^i \partial_i|_a (f\circ \varphi^{-1}) =\varphi_{*,x}D (f\circ \varphi^{-1}) = D(f).
	  \end{equation*}

	  En general, como ya vimos en la demostración de la Proposición \ref{equiv1}, una aplicación diferenciable $f:M\rightarrow N$ entre dos variedades diferenciables $M$ y $N$ induce, para cada abierto $V\subset N$, una aplicación
	  \begin{align*}
	    f^*_V :C^\infty_N(V)&\longrightarrow C^\infty_M(f^{-1}(V))\\ 
	      s &\longmapsto s\circ f. 
	    \end{align*}
	    Esta aplicación desciende a las espigas y permite definir una aplicación lineal $f_{*,x}:T_xM \rightarrow T_{f(x)} N$ de forma que, si $s\in C^\infty_{N,f(x)}$ y $D\in T_xM$,
	    \begin{equation*}
	      (f_{*,x} D)(s)=D(s\circ f).
	    \end{equation*}
	    Definimos entonces la \emph{derivada de $f$ en $x$} simplemente como la aplicación lineal $$d_xf=f_{*,x}:T_xM \rightarrow T_{f(x)}N.$$

	    Finalmente, es inmediato obtener una relación canónica entre el espacio tangente \textit{abstracto} $T_xM$, es decir, el definido como espacio de derivaciones y el espacio tangente \textit{sumergido}, definido como la imagen de la derivada de una parametrización. Por un momento denotaremos $\widetilde{T_xM}$ al espacio tangente sumergido. Podemos definir un isomorfismo entre $T_xM$ y $\widetilde{T_xM}$ simplemente enviando los vectores $\varphi_{*,x}(\partial_i|_{\varphi(x)})$ a los vectores $\frac{\partial \psi}{\partial x^i}$, con $\psi=\varphi^{-1}$. Tenemos entonces, para cada aplicación diferenciable $f:M\rightarrow N$, el siguiente diagrama conmutativo
	    \begin{center}
	      \begin{tikzcd}
		\widetilde{T_xM}		\arrow{rr}{d_xf}\arrow{dd} && \widetilde{T_{f(x)}N}\arrow{dd} \\ 
		 && \\
		 T_xM\arrow{rr}[anchor=south]{f_{*,x}} && T_xN,
	       \end{tikzcd}
	     \end{center}
	     donde las flechas verticales representan el isomorfismo canónico recién definido y $d_xf$ se entiende como la diferencial en el caso sumergido.

	     Es inmediato comprobar que en ambos casos la regla de la cadena se sigue cumpliendo, es decir $d_x(g\circ f)=d_{f(x)}g \circ d_xf$. Por tanto, si consideramos la categoría $\mathbf{Diff}_*$ de las variedades diferenciables \emph{con punto base} cuyos objetos son los pares $(M,x)$, con $M$ una variedad diferenciable y $x\in M$ y tal que los morfismos entre $(M,x)$ y $(N,y)$ son las aplicaciones diferenciables $f:M\rightarrow N$ tales que $f(x)=y$, entonces tenemos un funtor covariante
	     \begin{align*}
	       T :\mathbf{Diff}_*&\longrightarrow \mathbf{Vect}_\RR
	       \end{align*}
	       que a cada par $(M,x)$ le asigna el espacio vectorial $T_xM$ y a cada aplicación diferenciable $f:(M,x)\rightarrow (N,f(x))$ le asigna la aplicación lineal $d_xf:T_xM \rightarrow T_{f(x)}N$.



	       \section{El espacio cotangente}
	       \begin{defn}
		 Sea $M$ una variedad diferenciable y $x\in M$. Llamamos \emph{espacio cotangente a $M$ en $x$} al dual del espacio tangente a $M$ en $x$, es decir, a $T^*_xM:=(T_xM)^*$.
	       \end{defn}

	       Recordemos que si $V$ es un espacio vectorial y $\left\{ \ve{e}_1,\dots,\ve{e}_n \right\}$ es una base de $V$, entonces podemos considerar su \emph{base dual}, $\left\{ \eps^1,\dots,\eps^n \right\}$, con $\eps^i(\ve{e}_j)=\delta^i_j$, que es una base de $V^*$. Recordemos también que, si $W$ es otro espacio vectorial y $f:V\rightarrow W$ es una aplicación lineal, podemos definir su aplicación traspuesta 
	       \begin{align*}
		 f^* :W^*&\longrightarrow V^*\\ 
		   \alpha  &\longmapsto \alpha \circ f. 
		 \end{align*}
	       Es decir, a cada forma lineal $\alpha:W\rightarrow \RR$ la aplicación traspuesta le asocia la forma $(f^*\alpha)$ tal que, si $\ve{u} \in V$, 
	       \begin{equation*}
		 (f^*\alpha)(\ve{u})=\alpha(f(\ve{u})).
	       \end{equation*}

	       Consideramos ahora el espacio cotangente $T_a^*\RR^n$ en cierto punto $a\in \RR^n$ y denotamos por $\left\{ dx^1_a,\dots,dx^n_a \right\}$ a la base dual de $\left\{ \partial_1|_a,\dots,\partial_n|_a \right\}$. Una forma $\alpha \in T_a^*\RR^n$ puede entonces escribirse como 
	       \begin{equation*}
		 \alpha=\sum_i \alpha_i(a) dx^i_a,
	       \end{equation*}
	       con $\alpha_i(a)=\alpha(\partial_i|_a)$.
	       Ahora, si $M$ es una variedad diferenciable de dimensión $n$ y $T^*_xM$ es el espacio cotangente a $M$ en un punto $x\in M$, la aplicación traspuesta del isomorfismo $\varphi_{*,x}:T_xM \rightarrow T_{\varphi(x)}\RR^n$, inducido canónicamente por una carta $(U,\varphi)$, es un isomorfismo
	       \begin{align*}
		 \varphi^*_x :T_{\varphi(x)}\RR^n &\longrightarrow T_x M\\ 
		 \alpha &\longmapsto \alpha \circ \varphi_{*,x}. 
		 \end{align*}

		 Así, toda forma lineal $\alpha \in T_x^*M$ tiene el aspecto
		 \begin{equation*}
		   \alpha = \varphi^*_x\left(\sum_i \alpha_i(\varphi(x)) dx^i_{\varphi(x)}\right)=\sum_i \alpha_i(\varphi(x)) \varphi^*_x(dx^i_{\varphi(x)})=\sum_i \alpha_i (\varphi(x)) dx^i_{\varphi(x)} \circ \varphi_{*,x}.
		 \end{equation*}
		 Más concretamente, si tenemos una derivación $D\in T_xM$ tal que $\varphi_{*,x} D=\sum_i u^i\partial_i |_{\varphi(x)}$, entonces
		 \begin{equation*}
		   \alpha(D) = \sum_i \alpha_i(\varphi(x)) dx^i_{\varphi(x)}(\varphi_{*,x} D) = \sum_i \alpha_i(\varphi(x)) dx^i_{\varphi(x)}\left(\sum_j u^j \partial_j|_{\varphi(x)}\right)= \sum_i u^i \alpha_i(\varphi(x)).
		 \end{equation*}


	  \chapter{Fibrados vectoriales}
	  \section{La categoría de los fibrados vectoriales}
	  \section{Secciones de un fibrado vectorial}
	  (Haces de módulos y fibrados vectoriales)
	  \section{El fibrado tangente y el fibrado cotangente}
	  (Campos y 1-formas)
	  \section{Referencias móviles}

	  \chapter{Ecuaciones diferenciales en variedades}
	  \section{Flujos completos}
	  \section{Flujos}
	  \section{Integración de campos}
	  \section{Derivada de Lie}
	  \section{Campos coordenados}
	  \chapter{Grupos y álgebras de Lie}
	  \section{Grupos de Lie}
	  \section{El álgebra de Lie de un grupo de Lie}
	  (Todo grupo de Lie es paralelizable)
	  \section{La aplicación exponencial}
	  \chapter{Tensores}
	  \section{Producto tensorial}
	  \section{El álgebra de tensores de un espacio vectorial}
	  \section{Tensores en variedades}
	  \section{Derivada de Lie de un tensor}
	  \section{Métricas riemmanianas}

	  \chapter{Formas diferenciales}
	  \section{El producto antisimétrico}
	  \section{Determinantes}
	  \section{Formas en variedades}
	  \section{Diferencial exterior}
	  \section{Fórmulas de Cartan}
	  \section{Cohomología de de Rham}
	  Lema de Poincaré
	  Cohomología de las esferas
	  \chapter{El teorema de de Rham}
	  \section{Cadenas y cocadenas}
	  \begin{defn}
	    Sean $M$ una variedad diferenciable y el intervalo $I=[0,1]$. Un \emph{$k$-cubo singular} en $M$ es una aplicación continua $c:I^k\rightarrow M$. Una \emph{$k$-cadena singular} en $M$ es una combinación entera formal de cubos singulares, es decir, un elemento de $C_k(M)$ el grupo abeliano generado por los $k$-cubos en $M$.
	  \end{defn}

	  Si consideramos $M$ como variedad sumergida podemos dar una noción de cubo diferenciable usando la noción de diferenciabilidad de la Definición \ref{difsumergida}. Así, un \emph{$k$-cubo diferenciable} es simplemente una aplicación diferenciable $c:I^k\rightarrow M$. Análogamente, definimos las \emph{$k$-cadenas singulares diferenciables} como el grupo abeliano generado por los $k$-cubos singulares diferenciables, que denotamos también $C_k(M)$, puesto que a partir de ahora tan solo consideraremos cubos y cadenas diferenciables.

	  Sea $C\in C_k(M)$ una $k$-cadena, se define la \emph{cara delantera $i$-ésima} como la $(k-1)$-cadena
	  \begin{equation*}
	    (F_i C)(t_1,\dots,t_{k-1})=C(t_1,\dots,t_{i-1},1,t_i,\dots,t_{k-1})
	  \end{equation*}
	  y la \emph{cara trasera $i$-ésima} como la $(k-1)$-cadena
	  \begin{equation*}
	    (B_i C)(t_1,\dots,t_{k-1})=C(t_1,\dots,t_{i-1},0,t_i,\dots,t_{k-1}).
	  \end{equation*}
	  Definimos el \emph{borde} de una $k$-cadena $C$ como la $(k-1)$-cadena
	  \begin{equation*}
	    \partial C= \sum_{i=1}^k (-1)^{i-1} (F_i C - B_i C).
	  \end{equation*}
	  \begin{prop}
	    Si $C$ es una $k$-cadena en $M$, $\partial(\partial C)=0$.
	  \end{prop}
\begin{proof}
  Basta comprobar las siguientes identidades, 
  \begin{align*}
    F_iF_j(C)&= F_{j-1}F_i(C)\\
    B_iB_j(C)&= B_{j-1}B_i(C)\\
    A_iB_j(C)&= B_{j-1}A_i(C)\\
    B_iA_j(C)&= A_{j-1}B_i(C),
  \end{align*}
  para $1\leq i < j \leq k$. Utilizando esto, el resultado se sigue de escribir la definición.
\end{proof}

Esta proposición nos informa de que, si consideramos el homomorfismo 
\begin{align*}
  \partial_k:C_{k}(M)&\longrightarrow C_{k-1}(M)\\ 
    C &\longmapsto \partial C, 
  \end{align*}
  entonces $\partial_{k-1}\circ \partial_k=0$. Esto implica que $\im \partial_{k+1} \subset \ker \partial_k$ y podemos definir el cociente
  \begin{equation*}
    H_k(M)=\frac{\ker \partial_k}{\im \partial_{k+1}}.
  \end{equation*}
  Este cociente se denomina \emph{$k$-ésimo grupo de homología singular (diferenciable) de $M$}.

Supongamos ahora que $G$ es un grupo abeliano. Podemos entonces considerar el grupo abeliano formado por los homomorfismos de grupos $C_k(M)\rightarrow G$, que denotamos
\begin{equation*}
  C^k(M;G)=\mathbf{Ab}(C_k(M),G).
\end{equation*}
Un elemento $\alpha \in C^k(M;G)$ se llama una \emph{$k$-cocadena singular (diferenciable) en $M$ con coeficientes en $G$}. El homomorfismo borde induce un homomorfismo \emph{coborde}, $\delta_k:C^k(M;G)\rightarrow C^{k+1}(M;G)$, de forma que, si $\alpha\in C^k(M;G)$ es una $k$-cocadena entonces el siguiente diagrama conmuta
\begin{center}
  \begin{tikzcd}
    C_{k+1}(M) \arrow{r}{\partial_{k+1}} \arrow{d}{\delta_k\alpha}  & C_k(M) \arrow{dl}{\alpha}  \\ 
    G.
  \end{tikzcd}
\end{center}
Claramente, si $\alpha \in C^{k}(M;G)$ y $C\in C^{k+2}(M;G)$, entonces $$\delta_{k}(\delta_{k-1} \alpha)(C)=\delta_{k-1} \alpha (\partial_{k+1} C)=\alpha(\partial_{k} (\partial_{k+1}(C)))=0.$$
Por tanto, $\im \delta_{k-1} \subset \ker \delta_k$, con lo que podemos definir el cociente
\begin{equation*}
  H^k(M;G)=\frac{\ker \delta_k}{\im \delta_{k-1}}.
\end{equation*}
Este cociente se denomina \emph{$k$-ésimo grupo de cohomología singular (diferenciable) de $M$ con coeficientes en $G$}.

Vamos a relacionar ahora los grupos de homología con los de cohomología. En particular, nos interesa el caso en el que el grupo de coeficientes es un cuerpo, $G=K$. En tal caso, es posible dotar a los grupos de cohomología de la estructura de $K$-espacio vectorial, simplemente, si $\alpha, \beta \in C^k(M;K)$ son dos cocadenas y $\lambda, \mu \in K$, definimos
\begin{equation*}
  (\lambda \alpha + \mu \beta)(C)=\lambda \alpha(C) + \mu \beta(C).
\end{equation*}
Más aún, a nosotros nos va interesar el caso de coeficientes reales, $K=\RR$, aunque los resultados que vamos a usar son ciertos para cualquier otro cuerpo de característica $0$, por ejemplo $\CC$ o $\mathbb{Q}$. El siguiente lema de teoría de grupos nos ayudará en lo que sigue:
\begin{lema}
  Sea $\KK$ un cuerpo de característica 0. Si $G$ es un grupo abeliano, cualquier homomorfismo de grupos de un subgrupo de $G$ a $\KK$ se puede extender a $G$.
\end{lema}

\begin{proof}
  Supongamos que $H<G$ es un subgrupo y $f:H\rightarrow \KK$ es un homomorfismo. Consideramos el conjunto $\mathscr{P}$ de los pares $(H',f')$, con $H<H'<G$ y $f':H'\rightarrow \KK$ una extensión de $f$. Definimos un orden parcial en $\mathscr{P}$ declarando $(H',f')\leq(H'',f'')$ si $H'<H''$ y $f''|_{H'}=f'$. Si $\mathscr{T}\subset \mathscr{P}$ es una subconjunto linealmente ordenado, definimos $\tilde{H}$ como la unión de los $H'$ tales que $(H',f')\in \mathscr{T}$ y el homomorfismo (que es único) $\tilde{f}:\tilde{H}\rightarrow \KK$ tal que $\tilde{f}(h) = f'(h)$, con $(H',f') \in \mathscr{T}$ y $h\in H'$. El par $(\tilde{H},\tilde{f})$ es una cota superior de $\mathscr{T}$. Por tanto, por el Lema de Zorn, existe un elemento maximal en $\mathscr{P}$ que denotaremos $(H_0,f_0)$.

  Si $H_0=G$ hemos terminado. En caso contrario, existe un elemento $g\in G$ tal que $g\not\in H_0$. Sea $H_g$ el subgrupo $H_0+g\ZZ<G$. El grupo cociente $H_g/H_0=g\ZZ$. Si $H_g/H_0$ es infinito, entonces $m g \not\in H_0$ para todo $m\in \ZZ$ y podemos definir una extensión $f'_0$ de $f_0$ haciendo $f'_0(h+mg)=f_0(h)$, para $h\in H_0$ y $m\in \ZZ$. Por otra parte, si $H_g/H_0$ es finito, llamamos $n$ a su orden, de modo que $mg\in H_0$ si y sólo si $m\in n\ZZ$. Ahora, como $\KK$ es de característica $0$, hay una aplicación inyectiva $\ZZ \hookrightarrow \KK$ e identificamos $\ZZ$ con su imagen por esta aplicación. Consideramos entonces el elemento $k=f_0(ng)/n \in \KK$ y definimos una extensión $f_0'$ de $f_0$ por
  \begin{equation*}
    f_0'(h+mg)=f_0(h)+mk.
  \end{equation*}
  Para ver que está bien definida, consideremos dos elementos $h,h' \in H_0$ tales que existen $m,m'\in \ZZ$ con $h+gm=h'+gm'$. Tenemos entonces que $(m-m')g=h'-h\in H_0$, luego $m-m'=jn$ para cierto $j\in \ZZ$. Ahora,
  \begin{align*}
    f_0'(h+mg)-f_0'(h'+m'g)&=(f_0(h)+mk)-(f_0(h')+m'k)\\&=f_0(h-h')+(m-m')k=f_0(-jng)+jnk =0.
  \end{align*}
En cualquier caso, hemos encontrado una extensión $f_0'$ de $f_0$ a un grupo que contiene estrictamente a $H_0$, lo que contradice la maximalidad de $(H_0,f_0)$. Por tanto, $H_0=G$.
\end{proof}

\begin{prop}
  Sea $\KK$ un cuerpo de característica $0$ y $M$ una variedad diferenciable. Entonces $H^k(M;\KK)$ es un espacio vectorial isomorfo a $\mathbf{Ab}(H_k(M),\KK)$.
\end{prop}

\begin{proof}
  Una $k$-cocadena $\alpha$ tal que $\delta \alpha = 0$ define un homomorfismo
  \begin{align*}
    \tilde{\alpha}:H_k(M)&\longrightarrow \KK\\ 
     [C] &\longmapsto \alpha(C),
    \end{align*}
    que está bien definido porque $\alpha(\partial B)=\delta \alpha(B)=0$. Ahora, si $\alpha=\delta \beta$, entonces $\alpha(C)=\delta \beta (C)=\beta (\partial C)=0$, luego, si llamamos
    \begin{align*}
      \psi_k :\ker \delta_k&\longrightarrow \mathbf{Ab}(H_k(M),\KK)\\ 
      \alpha &\longmapsto \tilde{\alpha}, 
      \end{align*}
    tenemos que
    $\im \delta_{k-1} \subset \ker \psi_k$, para cada $k\in \NN$. Por tanto, $\psi_k$ desciende a un homomorfismo 
    \begin{align*}
      \psi :H^k(M;\KK)&\longrightarrow \mathbf{Ab}(H_k(M),\KK)\\ 
      [\alpha] &\longmapsto \tilde{\alpha}. 
      \end{align*}
Vamos a probar que $\psi$ es de hecho un isomorfismo.

Sea un homomorfismo $f\in \mathbf{Ab}(H_k(M),\KK)$. Denotamos por $\pi:\ker \delta_k \rightarrow H^k(M;\KK)$ la proyección canónica al cociente. Podemos considerar entonces el homomorfismo $f\circ \pi: \ker \delta_k \rightarrow \KK$, que por el Lema se extiende a un homomorfismo $\alpha_f:C_k(X)\rightarrow \KK$, es decir, $\alpha_f$ es una $k$-cocadena. Más aún,
\begin{equation*}
  \delta \alpha_f (C)=\alpha_f (\partial C) = f\circ \pi (\partial C) =f [\partial C] = f(0) =0.
\end{equation*}
Tenemos entonces que $$\psi([\alpha_f])([C])=\tilde{\alpha_f}([C])=\alpha_f(C)=f\circ \pi (C)=f[C].$$ Con lo cual, $\psi([\alpha_f])=f$, luego $\psi$ es sobreyectiva. 

Para ver que $\psi$ es inyectiva, tomemos $[\alpha] \in H^k(M; \KK)$ tal que $\psi[\alpha]=0$. Esto significa que $\alpha \in C^k(M; \KK)$ cumple $\alpha(C)=0$ para todo $C\in C_k(M)$ con $\partial C = 0$. Es decir, $\ker \partial_k \subset \ker \alpha$. Por tanto,  $\alpha$ desciende a un homomorfismo $\tilde{\alpha}:C_k(M)/\ker \partial_k \rightarrow \KK$. Por otra parte, $\partial_k$ desciende a un isomorfismo
$\tilde{\partial}_k :C_k(M)/\ker \partial_k\rightarrow \im \partial_k$. Podemos componer para obtener un homomorfismo $\tilde{\alpha}\circ \tilde{\partial}_k^{-1}: \im \partial_k \rightarrow \KK$ que, por el Lema, se extiende a un homomorfismo $\beta:C_{k-1}(M) \rightarrow \KK$. Ahora, si $C\in C_k(M)$,
\begin{equation*}
  \delta \beta(C)=\beta(\partial C)=\tilde{\alpha}\circ \tilde{\partial}_k^{-1}(\partial C)=\alpha(C),
\end{equation*}
con lo que $\alpha = \delta \beta$, luego $[\alpha]=0$. Por tanto, $\psi$ es inyectiva.
\end{proof}
\begin{obs}
  Todos los resultados expuestos hasta ahora en esta sección son válidos también si $X$ es un espacio topológico cualquiera y consideramos cadenas no diferenciables en $X$ y sus respectivos grupos de homología y cohomología singular no diferenciables. Sin embargo, a nosotros sólo nos va interesar trabajar con cadenas diferenciables.
\end{obs}


	  \section{Integración en cadenas}
	  Entendemos por una forma diferenciable en el cubo $I^k$ una forma diferenciable en algún entorno suyo $U\supset I^k$. Si $\omega$ es una $k$-forma en $I^k$, entonces existe una función $f:I^k \rightarrow \RR$ diferenciable (en el sentido de la definición \ref{difsumergida}) tal que $\omega=f dx^1\wedge\dots\wedge dx^k$. Definimos entonces la \emph{integral de $\omega$ en $I^k$} como 
	  \begin{equation*}
	    \int_{I^k} \omega = \int_{I^k}f= \int_{I^k} f(x^1,\dots,x^k) dx^1\dots dx^k.
	  \end{equation*}

	  Ahora, si $c:I^k \rightarrow M$ es un $k$-cubo diferenciable en una variedad diferenciable $M$, entonces por definición existe una aplicación diferenciable $\tilde{c}:U\subset \RR^k\rightarrow M$, con $U$ un entorno abierto de $I^k$ tal que $\tilde{c}|_{I^k}=c$. Puedo considerar entonces la pullback $\tilde{c}^*:\Omega^k(M)\rightarrow \Omega^k(U)$. Ahora, si $\omega \in \Omega^k(M)$, denotamos $c^* \omega=\tilde{c}^* \omega |_{I^k}$, que, con nuestra definición, es una forma diferenciable en $I^k$. Podemos definir enotnces la \emph{integral de $\omega$ en $c$} como
	  \begin{equation*}
	    \int_c \omega = \int_{I^k} c^* \omega.
	  \end{equation*}
	  Nótese que la continuidad de las derivadas garantiza que las definiciones no dependan de la elección de la extensión $\tilde{c}$, ya que para cualquier extensión las derivadas en el borde deben coincidir.

	  Finalmente, si $C=\sum_i a_i c_i \subset C_k(M)$ es una $k$-cadena diferenciable y $\omega \in \Omega^k(M)$ es una $k$-forma diferenciable, definimos la \emph{integral de $\omega$ en $C$} como
	  \begin{equation*}
	    \int_C \omega = \sum_i a_i \int_{c_i}\omega.
	  \end{equation*}

	  \begin{thm}[Teorema de Stokes para cadenas]
	    Sea $\omega \in \Omega^{k-1}(M)$ una $(k-1)$-forma diferenciable en una variedad diferenciable $M$ y $C\in C_k(M)$ una $k$-cadena diferenciable en $M$. Entonces
	    \begin{equation*}
	      \int_C d\omega = \int_{\partial C}\omega.
	    \end{equation*}
	  \end{thm}
	  \begin{proof}
	    Veamos primero que el resultado es cierto para el \emph{$k$-cubo estándar} $i_k:I^k\hookrightarrow \RR^k$ y para $\omega$ una $(k-1)$-forma en $I^k$. Tenemos que $\omega$ puede escribirse en la forma
	    \begin{equation*}
	      \omega= \sum_i f_i dx^1 \wedge\cdots \wedge \hat{dx^i} \wedge \cdots \wedge dx^k,
	    \end{equation*}
	    donde el circunflejo denota que ese término se omite. Basta entonces probar el resultado para cada uno de estos términos. 
	    Nótese que
	    \begin{equation*}
	      \int_{I^{k-1}} (F_ji_k)^*(f_i dx^1 \wedge\cdots \wedge \hat{dx^i} \wedge \cdots \wedge dx^k)= 
	      \begin{cases}
		0 & \text{si } j \neq i, \\
		\int_{I^k}f_i(x^1,\dots,1,\dots,x^k)dx^1\cdots dx^k & \text{si } j=i,
	      \end{cases}
	    \end{equation*}
	    y que
	    \begin{equation*}
	      \int_{I^{k-1}} (B_ji_k)^*(f_i dx^1 \wedge\cdots \wedge \hat{dx^i} \wedge \cdots \wedge dx^k)= 
	      \begin{cases}
		0 & \text{si } j \neq i, \\
		\int_{I^k}f_i(x^1,\dots,0,\dots,x^k)dx^1\cdots dx^k & \text{si } j=i,
	      \end{cases}
	    \end{equation*}
	    Por tanto
	    \begin{align*}
	      \int_{\partial i_k}f_i dx^1 \wedge \cdots \wedge &\hat{dx^i} \wedge \cdots \wedge dx^k = \sum_{j=1}^k (-1)^{j-1} (F_j i_k - B_j i_k)^*(f_i dx^1 \wedge \cdots \wedge \hat{dx^i} \wedge \cdots \wedge dx^k) \\
	      &=(-1)^{i-1}  \int_{I^k} [f_i (x^1,\dots,1,\dots,x^k)- f_i(x^1,\dots,0,\dots,x^k)]dx^1\cdots dx^k .
	    \end{align*}

	    Por otra parte, 
	    \begin{align*}
	      \int_{I_k} d(f_i dx^1 & \wedge \cdots \wedge \hat{dx^i} \wedge \cdots \wedge dx^k) =  \\ & \int_{I^k} \frac{\partial f_i}{\partial x^i} dx^i \wedge dx^1 \wedge \cdots \wedge \hat{dx^i} \wedge \cdots \wedge dx^k = (-1)^{i-1}\int_{I^k}\frac{\partial f_i}{\partial x^i}.
	    \end{align*}
	    Ahora, usando el teorema fundamental del cálculo, tenemos que
	    \begin{align*}
	      (-1)^{i-1}&\int_{I^k}  \frac{\partial f_i}{\partial x^i}= (-1)^{i-1}\int_0^1 \overset{(k-1)}{\cdots} \int_0^1 \left(\int_0^1 \frac{\partial f_i}{\partial x^i} dx^i \right) dx^1\cdots \hat{dx^i} \cdots dx^k \\
&= (-1)^{i-1}\int_0^1 \overset{(k-1)}{\cdots} \int_0^1 \left(f_i(x^1,\dots,1,\dots,x^k)-f_i(x^1,\dots,0,\dots,x^k) \right) dx^1\cdots \hat{dx^i} \cdots dx^k \\
&=(-1)^{i-1}  \int_{I^k} [f_i (x^1,\dots,1,\dots,x^k)- f_i(x^1,\dots,0,\dots,x^k)]dx^1\cdots dx^k .
	    \end{align*}
	    Hemos probado entonces
	    \begin{equation*}
	      \int_{i_k} d\omega = \int_{\partial i_k} \omega.
	    \end{equation*}

	    Ahora, si $c$ es un $k$-cubo, como $c=c\circ i_k$, es fácil comprobar que $\partial c= c \circ  \partial i_k$, de modo que
	    \begin{equation*}
	      \int_{\partial c} \omega = \int_{\partial i_k} c^* \omega.
	    \end{equation*}
	    Por tanto
	    \begin{equation*}
	      \int_c d\omega = \int_{i_k} c^* (d\omega) = \int_{i_k} d(c^*\omega)=\int_{\partial i_k} c^*\omega = \int_{\partial c} \omega.
	    \end{equation*}
	    Finalmente, si $C=\sum_i a_i c_i$ es una $k$-cadena, entonces $\partial C=\sum_i a_i \partial c_i$, luego 
	    \begin{equation*}
	      \int_C d\omega = \sum_i a_i \int_{c_i} d\omega = \sum_i a_i \int_{\partial c_i} \omega = \int_{\partial C} \omega.
	    \end{equation*}
	  \end{proof}

	  Nótese que la integral nos permite definir un homomorfismo de grupos
	  \begin{align*}
	     \Omega^k(M)&\longrightarrow C^k(M;\RR)\\ 
	      \omega &\longmapsto \int_\bullet \omega, 
	    \end{align*}
	    con 
	    \begin{align*}
	      \int_\bullet \omega :C_k(M)&\longrightarrow \RR\\ 
	        C &\longmapsto \int_C \omega. 
	      \end{align*}
	      Más aún, a la vista del teorema de Stokes, podemos hacer que este homomorfismo descienda a las cohomologías,
	      \begin{align*}
		\mathcal{I}:	H_{dR}^k(M)&\longrightarrow H^k(M; \RR)\\ 
		[\omega] &\longmapsto \left[\int_\bullet \omega\right]. 
		\end{align*}
		En efecto, esta aplicación está bien definida ya que, si $\omega, \omega' \in Z^k(M)$ son $k$-formas cerradas con $\omega-\omega'=d\alpha$ y $C\in C_k(M)$ es una $k$-cadena con $\partial C=0$, entonces, por el teorema de Stokes
		\begin{equation*}
		  \int_C \omega - \int_C \omega' = \int_C \omega-\omega' = \int_C d\alpha = \int_{\partial C} \omega =0.
		\end{equation*}
		Por tanto, $\int_\bullet \omega$ = $\int_\bullet \omega'$.

		Por otra parte, $\left[ \int_\bullet \omega \right]$ es simplemente la aplicación
		\begin{align*}
		  H_k(M) &\longrightarrow \RR\\ 
		  [C] &\longmapsto \int_C \omega, 
		  \end{align*}
		  que está bien definida porque, si $C,C'\in C_k(M)$ son dos $k$-cadenas con $C-C'=\partial B$ y $\omega \in Z^k(M)$ es una forma cerrada, entonces, de nuevo por el teorema de Stokes
		  \begin{equation*}
		    \int_C \omega - \int_{C'}\omega = \int_{I^k} C^*\omega - C'^*\omega = \int_{C-C'} \omega=\int_{\partial B} \omega = \int_{B} d\omega =0.
		  \end{equation*}
		  
		  El teorema de de Rham afirma que el homomorfismo $\mathcal{I}$ es, de hecho, un isomorfismo. El resto de este capítulo está dedicado a desarrollar los conceptos necesarios para la demostración de este teorema.
	  \section{Cohomología de \v{C}ech}
	  Sea $\mathcal{U}$ un recubrimiento abierto de una variedad diferenciable $M$. Una colección ordenada $(U_0,\dots,U_k)$ de miembros del recubrimiento tales que $U_0 \cap \cdots \cap U_k \neq \varnothing$ se llama un \emph{$k$-simplejo}. Si $\sigma=(U_0,\dots,U_k)$ es un $k$-simplejo, su \emph{soporte} $|\sigma|$ se define como
	  \begin{equation*}
	    |\sigma|=U_0 \cap \dots \cap U_q.
	  \end{equation*}
	  La \emph{$i$-ésima cara} de un $k$-simplejo $\sigma=(U_0,\dots,U_k)$ es el $(k-1)$-simplejo $$\sigma_i=(U_0,\dots,U_{i-1},U_{i+1},\dots,U_k).$$ 
	  \begin{defn}
	    Sea $M$ una variedad diferenciable, $\FF$ un haz en $M$ y $\mathcal{U}$ un recubrimiento abierto de $M$. Una \emph{$k$-cocadena de \v{C}ech} es una función $\alpha$ que a cada $k$-simplejo $\sigma$ le asocia un elemento de $\FF(|\sigma|)$. El conjunto de las $k$-cocadenas de \v{C}ech es un grupo abeliano que denotamos por $\check{C}^k(\mathcal{U},\FF)$.
	    Si $\alpha$ es una $k$-cocadena, se define el \emph{coborde} de $\alpha$ como la $(k+1)$-cocadena
	    \begin{equation*}
	      d\alpha (\sigma) = \sum_{i=0}^k (-1)^i \mathrm{res}^{|\sigma_i|}_{|\sigma|} (\alpha(\sigma_i)),
	    \end{equation*}
	    con $\sigma$ un $(k+1)$-simplejo.
	    Es fácil comprobar que $d$ induce un homomorfismo de grupos $d_k:\check{C}^k(\mathcal{U},\FF) \rightarrow \check{C}^{k+1}(\mathcal{U},\FF)$ y que $d_{k+1}\circ d_k=0$. Definimos entonces \emph{$k$-ésimo grupo de cohomología de \v{C}ech con coeficientes en $\FF$ con respecto al recubrimiento $\mathcal{U}$} como el cociente
	    \begin{equation*}
	      \check{H}^k(\mathcal{U},\FF)=\frac{\ker d_k}{ \im d_{k-1}}.
	    \end{equation*}
	  \end{defn}
	  \begin{obs}
	    Una cocadena $\alpha$ pertenece a $\check{C}^0(\mathcal{U},\FF)$ si y sólo si $\alpha$ asigna a cada abierto $U\in \mathcal{U}$ un elemento de $\FF(U)$. Además, $d\alpha=0$ si y sólo si
	    \begin{equation*}
	      0=d\alpha(U_{i_0},U_{i_1})=\mathrm{res}^{U_{i_1}}_{U_{i_0}\cap U_{i_1}}\alpha(U_{i_1}) - \mathrm{res}^{U_{i_0}}_{U_{i_0}\cap U_{i_1}}\alpha(U_{i_0})
	    \end{equation*}
	    para todo $1$-simplejo $(U_{i_0},U_{i_1})$. Por tanto, por la propiedad de pegado del haz $\FF$, $d\alpha=0$ si y sólo si $\alpha$ está definida globalmente en $M$, es decir, $\alpha\in \FF(M)$. Tenemos entonces
	    \begin{equation*}
	      \check{H}^0(\mathcal{U},\FF)=\FF(M).
	    \end{equation*}
	  \end{obs}
	  \begin{defn}
	    Sean $\mathcal{U}$ y $\mathcal{V}$ recubrimientos abiertos de $M$. Decimos que $\mathcal{V}$ es un \emph{refinamiento} de $\mathcal{U}$ si cada elemento de $\mathcal{V}$ está contenido en un elemento de $\mathcal{U}$. Llamamos una \emph{aplicación de refinamiento} a una $\mu: \mathcal{V} \rightarrow \mathcal{U}$ tal que $V\subset \mu(V)$ para cada $V\in \mathcal{V}$.
	  \end{defn}
	  Supongamos que $\mathcal{V}$ es un refinamiento de un recubrimiento $\mathcal{U}$ con aplicación de refinamiento $\mu$. Si $\sigma=(V_0,\dots,V_k)$ es un $k$-simplejo del recubrimiento $\mathcal{V}$, entonces denotamos $\mu(\sigma)=(\mu(V_0),\dots,\mu(V_k))$, que es un $k$-simplejo de $\mathcal{U}$. Tenemos entonces que $\mu$ induce una aplicación en las cocadenas $\mu_k:C^k(\mathcal{U},\FF) \rightarrow C^k(\mathcal{V},\FF)$ por
	  \begin{equation*}
	    \mu_k(\alpha)(\sigma)=\mathrm{res}^{|\mu(\sigma)|}_{|\sigma|} \alpha(\mu(\sigma)),
	  \end{equation*}
	  con $\alpha \in C^k(\mathcal{U},\FF)$ y $\sigma$ un $k$-simplejo de $\mathcal{V}$.
	  Esta aplicación en las cocadenas desciende a las cohomologías
	  \begin{equation*}
	    \mu_k^*:\check{H}^k(\mathcal{U},\FF) \rightarrow \check{H}^k(\mathcal{V},\FF).
	  \end{equation*}

	  Ahora, si $\mu$ y $\tau$ son aplicaciones de refinamiento y $\sigma=(V_0,\dots,V_{k-1})$ es un $(k-1)$-simplejo de $\mathcal{V}$, definimos
	  \begin{equation*}
	    \tilde{\sigma}_j=(\mu(V_0),\dots,\mu(V_j),\tau(V_j),\dots,\tau(V_{k-1}),
	  \end{equation*}
	  y el homomorfismo $h_k:C^k(\mathcal{U},\FF)\rightarrow C^{k-1}(\mathcal{V},\FF)$ por
	  \begin{equation*}
	    h_k(\alpha)(\sigma)=\sum_{j=0}^{k-1}(-1)^j \mathrm{res}^{|\tilde{\sigma}_j|}_{|\sigma|}\alpha(\tilde{\sigma}_j).
	  \end{equation*}
	  Un cálculo directo muestra que
	  \begin{equation*}
	    h_{k+1}\circ d + d \circ h_k = \tau_k -\mu_k.
	  \end{equation*}
	  Por tanto, si $[\alpha] \in \check{H}^k(\mathcal{U},\FF)$, entonces
	  \begin{equation*}
	\tau_k^*([\alpha])-\mu_k^*([\alpha])=    h^*_{k+1}(d[\alpha])+d(h^*_k[\alpha])= h^*_{k+1}([d\alpha])+[d(h_k(\alpha))]=0,
	  \end{equation*}
	  con lo que $\tau_k^*=\mu_k^*$. Tenemos entonces que el sistema parcialmente ordenado de los recubrimientos abiertos con respecto al refinamiento, induce un orden parcial en las cohomologías de \v{C}ech mediante los morfismos inducidos por las aplicaciones de refinamiento. Más aún, si $\mathcal{W}$ es un refinamiento de un refinamiento $\mathcal{V}$ de $\mathcal{U}$, entonces el siguiente diagrama conmuta
	  \begin{center}
	    \begin{tikzcd}
	      \check{H}^k(\mathcal{U},\FF) \arrow{r} \arrow[bend left]{rr} &\check{H}^k(\mathcal{V},\FF) \arrow{r} &\check{H}^k(\mathcal{W},\FF),
	    \end{tikzcd}
	  \end{center}
	  con lo que tenemos un sistema directo en las cohomologías según el refinamiento y podemos considerar el límite directo
	  \begin{equation*}
	    \check{H}^k(M,\FF)=\varinjlim_{\mathcal{U}} \check{H}^k(\mathcal{U},\FF).
	  \end{equation*}
	  Este grupo $\check{H}^k(M,\FF)$ se denomina el \emph{$k$-ésimo grupo de cohomología de \v{C}ech de $M$ con coeficientes en $\FF$}.
	  \begin{defn}
	    Un haz $\FF$ de grupos abelianos en una variedad diferenciable $M$ se dice \emph{fino} si para cada abierto $U\subset M$ y para cada recubrimiento $\mathcal{V}$ localmente finito de $U$, existen aplicaciones de \emph{extensión} $\theta_V^U:\FF(V)\rightarrow \FF(U)$ tales que
	    \begin{equation*}
	      \sum_{V\in \mathcal{V}}\theta_V^U\circ \mathrm{res}^U_V=\id_{\FF(U)}.
	    \end{equation*}
	  \end{defn}
	  \begin{ejemplo}
	    Si $M$ es una variedad diferenciable y $U\subset M$ un abierto todo recubrimiento abierto de $U$ admite un refinamiento $\mathcal{V}$ localmente finito. Sea $\Theta=\left\{ \theta_V:V\in \mathcal{V} \right\}$ una PDU subordinada a $\mathcal{V}$. Podemos considerar entonces los siguientes haces:

	      (1) Si consideramos el haz de funciones diferenciables $C^\infty_M$, entonces a cada función $f\in C^\infty_M(V)$ le podemos asignar la función 
		\begin{equation*}
		  \tilde{f}=
		  \begin{cases}
		    \theta_V f & \text{en } V \\
		    0 & \text{en } U-V.
		  \end{cases}
		\end{equation*}
		Ahora, por ser $\Theta$ una PDU, si $F\in \FF(U)$, entonces $$\sum_{V\in \mathcal{V}} \theta_V(x) F|_{V}(x) =F(x)\sum_{V\in \mathcal{V}}\theta(x)=F(x),$$ de modo que que $C^\infty_M$ es un haz fino.
	      
		(2) Si consideramos el haz de $k$-formas diferenciales $\Omega^k_M$ que a cada $V\subset M$ le asigna $\Omega^k(V)$, a cada $k$-forma $\omega \in \Omega^k(V)$ le podemos asignar la $k$-forma
		\begin{equation*}
		  \tilde{\omega}=
		  \begin{cases}
		    \theta_V \omega & \text{en } V \\
		    0 & \text{en } U-V.
		  \end{cases}
		\end{equation*}
		Igual que antes, si $\eta \in \Omega^k(U)$, entonces $\sum_{V\in \mathcal{V}} \theta_V \eta|_{V}=\eta$, de modo que $\Omega^k_M$ es un haz fino.
	      
		(3) Podemos dotar a las $k$-cocadenas con coeficientes en $\RR$ de la estructura de $C^\infty(M)$~-módulo, simplemente definiendo
  \begin{equation*}
    (f\cdot \alpha + g\cdot \beta)(c)=f(c(0,\dots,0)) \cdot \alpha(c) + g(c(0,\dots,0)) \cdot \beta(c),
  \end{equation*}
  con $f,g\in C^\infty(M)$, $\alpha, \beta \in C^k(M;\RR)$ y $c$ un $k$-cubo.
  Si consideramos el haz de $k$-cocadenas en $M$ con coeficientes en $\RR$, $C^k_M(\RR)$, que a cada $V \subset M$ le asigna $C^k(V;\RR)$, con las restricciones $$\mathrm{res}^U_V (\alpha)=\alpha|_{C_k(V)},$$ a cada $k$-cocadena $\alpha \in C^k(V;\RR)$ le podemos asignar la $k$-cocadena
  \begin{equation*}
    \tilde{\alpha}(c)=
    \begin{cases}
      \theta_V(c(0,\dots,0)) \cdot \alpha(c) &\text{si } c(I^k) \subset V\\
      0 &\text{en caso contrario},
    \end{cases}
  \end{equation*}
  con $c$ un $k$-cubo en $U$. Ahora, si $\beta \in C^k(U;\RR)$, entonces
  \begin{equation*}
    \sum_{V\in \mathcal{V}}\theta_V(c(0,\dots,0)) \beta|_{C_k(V)}(c)=\beta(c) \sum_{V\in \mathcal{V}}\theta_V(c(0,\dots,0)) = \beta(c).
  \end{equation*}
  Tenemos entonces que $C^k_M(\RR)$ también es un haz fino.
	  \end{ejemplo}
	  \begin{prop}
	    Si $\FF$ es un haz fino en $M$, entonces $\check{H}^k(M,\FF)=0$ para todo $k\in \NN$.
	  \end{prop}
	  \begin{proof}
	    Como todo recubrimiento de una variedad diferenciable $M$ admite un refinamiento localmente finito, basta probar que $\check{H}^k(\mathcal{U},\FF)=0$ para cada recubrimiento localmente finito $\mathcal{U}$ de $M$. Sea $\alpha \in \check{C}^k(\mathcal{U},\FF)$ y sea $\sigma=(U_0,\dots,U_{k-1})$ un $(k-1)$-simplejo de $\mathcal{U}$. Podemos considerar ahora la $(k-1)$-cocadena de \v{C}ech 
	    \begin{equation*}
	      h_k(\alpha)(\sigma)=\sum_{U\in\mathcal{U}}\left(\mathrm{res}^U_{U\cap|\sigma|}\circ \theta^U_{U\cap |\sigma|}\right)(\alpha(U,U_0,\dots,U_{k-1})).
	    \end{equation*}
	    Un cálculo directo muestra que
	    \begin{equation*}
	       h_{k+1}\circ d +d\circ h_k = \id.
	    \end{equation*}
	    Por tanto, si $[\alpha]\in \check{H}^k(\mathcal{U},\FF)$, entonces
	    \begin{equation*}
	[\alpha]=    h^*_{k+1}(d[\alpha])+d(h^*_k[\alpha])= h^*_{k+1}([d\alpha])+[d(h_k(\alpha))]=0,
	    \end{equation*}
	    luego $\check{H}^k(\mathcal{U},\FF)=0$.
	  \end{proof}
	  \section{Resoluciones de haces}
	  \begin{defn}
	    Sean $\FF$ y $\mathscr{G}$ dos haces sobre un espacio topológico $X$. Un \emph{morfismo de haces}  $h:\FF\rightarrow \mathscr{G}$ es simplemente una transformación natural entre los prehaces subyacentes, es decir, una colección de aplicaciones $h_U:\FF(U)\rightarrow \mathscr{G}(U)$ para cada abierto $U\subset X$ tal que el siguiente diagrama conmuta
	    \begin{center}
	      \begin{tikzcd}
		\FF(U)		\arrow{rr}{h_U}\arrow{dd}[anchor=east]{\mathrm{res}^U_V} && \mathscr{G}(U)\arrow{dd}[anchor=west]{\mathrm{res}^U_V} \\ 
		 && \\
		 \FF(V)\arrow{rr}[anchor=south]{h_V} && \mathscr{G}(V),
	       \end{tikzcd}
	     \end{center}
	     con $V\subset U \subset X$ abiertos.
	  \end{defn}
	  \begin{defn}
	    Si $\mathscr{A}$, $\mathscr{B}$ y $\mathscr{C}$ son haces de grupos abelianos en un espacio topológico $X$ y 
	    \begin{center}
	      \begin{tikzcd}
		\mathscr{A} \arrow{r}{g}& \mathscr{B} \arrow{r}{h} &\mathscr{C}
	      \end{tikzcd}
	    \end{center}
	    es una sucesión de morfismos de haces, entonces decimos que esta sucesión es \emph{exacta} en $\mathscr{B}$ si, para cada $x\in X$, la sucesión inducida en las espigas
	    \begin{center}
	      \begin{tikzcd}
		\mathscr{A}_x \arrow{r}{g_x}& \mathscr{B}_x \arrow{r}{h_x} &\mathscr{C}_x
	      \end{tikzcd}
	    \end{center}
	    es exacta en $\mathscr{B}_x$, es decir, si $\ker h_x = \im g_x$. 
	  \end{defn}
	  \begin{defn}
	    Sea $X$ un espacio topológico y $G$ un grupo abeliano. Se define el \emph{haz constante} $G_X$ como aquel que a cada abierto $U\subset X$ le asigna el propio grupo $G$ y donde las aplicaciones de restricción son simplemente la identidad.
	  \end{defn}
	  \begin{defn}
	    Sea $M$ una variedad diferenciable. Una \emph{resolución fina} de un haz $\FF$ de grupos abelianos en $M$ es una sucesión exacta de haces de la forma
	    \begin{center}
	      \begin{tikzcd}
		0_M\arrow{r}& \mathscr{F} \arrow{r}& \mathscr{F}^0 \arrow{r} &\mathscr{F}^1 \arrow{r} & \cdots \arrow{r} & \mathscr{F}^m \arrow{r}& \cdots,
	      \end{tikzcd}
	    \end{center}
	    con los $\mathscr{F}^i$ haces finos de grupos abelianos en $M$. Brevemente, esta resolución se denota
	    \begin{center}
	      \begin{tikzcd}
		0_M\arrow{r}& \mathscr{F} \arrow{r}& \mathscr{F}^*. 	      \end{tikzcd}
	    \end{center}
	  \end{defn}
	  \begin{thm}
	    Sea $\FF$ un haz de grupos abelianos en una variedad diferenciable $M$ y sea
	    \begin{center}
	      \begin{tikzcd}
		0_M\arrow{r}& \mathscr{F} \arrow{r}& \mathscr{F}^*,  
	      \end{tikzcd}
	    \end{center}
	    una resolución fina de $\FF$. Supongamos que $\mathcal{U}$ es un recubrimiento abierto de $M$ tal que, para cada $k$-simplejo $\sigma$ y para cada $j\in \NN$, la sucesión 
	    \begin{center}
	      \begin{tikzcd}
		\FF^{j-1}(|\sigma|)\arrow{r}& \mathscr{F}^j(|\sigma|) \arrow{r}& \mathscr{F}^{j+1}(|\sigma|),  
	      \end{tikzcd}
	    \end{center}
	    es exacta en $\FF^j(|\sigma|)$. Entonces
	    \begin{equation*}
	      \check{H}^k(\mathcal{U},\FF)\cong \frac{\ker (\FF^k(M)\rightarrow \FF^{k+1}(M))}{\im (\FF^{k-1}(M) \rightarrow \FF^{k}(M))}.
	    \end{equation*}
	  \end{thm}
	  \begin{proof}
	    
	  \end{proof}
	  \chapter{Orientación}
	  \section{Orientación de un espacio vectorial}
	  \section{Orientación de variedades}
	  \section{Orientación de hipersuperficies}
	  \section{Orientación del borde}
	  \chapter{Integración}
	  \section{Integral de una forma diferencial en una variedad}
	  \section{Teorema de Stokes}
	  \section{Elemento de volumen}
	  \section{Los teoremas clásicos}
	  \section{Cohomología e integración}
	  Cohomología con soportes compactos
	  Cohomología de grado máximo
	  Grado de una aplicación diferenciablex

	  
	  \appendix
	  \chapter{Topología de variedades}
	  \epigraph{\textit{Desde las Fronteras del Oeste, al pie de las Colinas de la Torre, hasta el Puente del Brandivino había unas cuarenta leguas y casi cincuenta desde los páramos del norte hasta los pantanos del sur. Los Hobbits denominaron a estas tierras la Comarca.} [...] \textit{Allí, en ese placentero rincón del mundo, llevaron una vida ordenada y dieron cada vez menos importancia al mundo exterior, donde se movían unas cosas oscuras\dots}}{}
	  \section{Particiones diferenciables de la unidad}
\begin{defn}
  Una \emph{partición diferenciable de la unidad} (abreviado PDU) en una variedad diferenciable $M$ es una familia $\Theta$ de funciones diferenciables en $M\rightarrow \RR$ tal que
  \begin{enumerate}
    \item $\theta \geq 0$ para todo $\theta \in \Theta$,
    \item es \emph{localmente finita}, es decir, cada punto $x\in M$ tiene un entorno $U\subset M$ en el que se anulan todas las $\theta \in \Theta$ salvo una cantidad finita y
    \item $\sum_{\theta\in \Theta} \theta=1$.
  \end{enumerate}

  Si $\mathcal{U}$ es un recubrimiento abierto de $M$, una partición diferenciable de la unidad \emph{subordinada a $\mathcal{U}$} es una PDU de la forma $\left\{ \theta_U : U\in \mathcal{U} \right\}$ tal que, para cada $U\in \mathcal{U}$, $\theta_U$ se anula fuera de $U$.
\end{defn}

\begin{defn}
  Sea $M\subset \RR^n$ una variedad diferenciable. 
  \begin{enumerate}
    \item Sean $A\subset M$ un conjunto cerrado y $U$ un entorno abierto de $A$. Una \emph{función meseta} (diferenciable) en $A$ es una función diferenciable y no negativa $\theta:M\rightarrow \RR$ que vale constantemente $1$ en $A$ y se anula fuera de $U$.
    \item Sean $A$ y $B$ dos cerrados disjuntos de $M$. Una \emph{función separante de Uryshon} (diferenciable) de $A$ y $B$ es una función diferenciable y no negativa $\theta:M\rightarrow \RR$ que vale constantemente $1$ en $A$ y $0$ en $B$.
  \end{enumerate}
\end{defn}

La existencia de funciones meseta diferenciables en $\RR^n$
garantiza la existencia de funciones meseta, separantes de Uryshon y particiones diferenciables de la unidad en las variedades diferenciables [ver apéndice]. Cabe destacar que en estas construcciones es crucial estar trabajando en la categoría diferenciable, ya que no existen funciones meseta analíticas, puesto que si una función analítica se anula en un abierto entonces debe ser idénticamente nula..

Las PDU son una herramienta realmente útil en toda la teoría de variedades diferenciables ya que nos permiten hacer construcciones globales a partir de construcciones locales. El ejemplo más claro de esto es el siguiente resultado:

\begin{prop}[Teorema de extensión de Tietze diferenciable]
  Sean $M$ una variedad dieferenciable, $A\subset M$ un cerrado y $f:A\rightarrow \RR$ una función diferenciable. Entonces existe una función diferenciable $F: M\rightarrow \RR$ tal que $F|_A=f$.
\end{prop}

\begin{proof}
  Por comodidad, supondremos $M$ sumergida en esta demostración. Tomamos un recubrimiento abierto $\mathcal{U}$ de $A$ y elegimos extensiones locales diferenciables $F_U:U\rightarrow \RR$ de $f|_{A\cap U}$, para cada $U\in \mathcal{U}$. Consideramos una PDU subordinada al recubrimiento $\mathcal{U} \cup \left\{ M-A \right\}$ y la función $F=\sum_{U\in \mathcal{U}} \theta_U F_U$. Ahora, si $x\in A$,
  $$
    F(x)=\sum_{U\in \mathcal{U}} \theta_U(x) F_U(x)=f(x) \sum_{U\in \mathcal{U}} \theta_U(x) = f(x).
    $$
    Con lo que $F|_A = f$.
\end{proof}

\chapter{Teoría de categorías}
\epigraph{\textit{Habla, amigo y entra}}{Inscripción en las Puertas de Durin, Señor de Moria}
\chapter{Prerrequisitos algebraicos}
		      \epigraph{\textit{Los Hobbits se deleitan con esas cosas, si son exactas; les encanta tener libros colmados de cosas que ya saben, expuestas sin contradicciones y honradamente.}}{}
\chapter{Prerrequisitos analíticos}
\epigraph{\textit{Muchos de los que viven merecen morir y algunos de los que mueren merecen la vida. ¿Puedes devolver la vida? Entonces no te apresures a dispensar la muerte, pues ni el más sabio conoce el fin de todos los caminos.} [...] \textit{El corazón me dice que todavía tiene un papel que desempeñar, para bien o para mal, antes del fin y cuando éste llegue\dots}}{Gandalf a Frodo, sobre Gollum}
		      \newpage\null\thispagestyle{empty}
		      \tableofcontents
		      \end{document}


